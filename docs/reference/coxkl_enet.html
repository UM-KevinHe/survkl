<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso &amp; Elastic Net Penalty — coxkl_enet • survkl</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso &amp; Elastic Net Penalty — coxkl_enet"><meta name="description" content="Fits a Cox proportional hazards model that incorporates external information
using Kullback–Leibler (KL) divergence, with an optional L1 (Lasso) or elastic net penalty on
the coefficients. External information can be supplied either as precomputed external
risk scores (RS) or as externally derived coefficients (beta). The integration
strength is controlled by the tuning parameter eta."><meta property="og:description" content="Fits a Cox proportional hazards model that incorporates external information
using Kullback–Leibler (KL) divergence, with an optional L1 (Lasso) or elastic net penalty on
the coefficients. External information can be supplied either as precomputed external
risk scores (RS) or as externally derived coefficients (beta). The integration
strength is controlled by the tuning parameter eta."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">survkl</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/survkl.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix"><li><a class="dropdown-item" href="../articles/Methods.html">Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/survkl" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso &amp; Elastic Net Penalty</h1>

      <div class="d-none name"><code>coxkl_enet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a Cox proportional hazards model that incorporates external information
using Kullback–Leibler (KL) divergence, with an optional L1 (Lasso) or elastic net penalty on
the coefficients. External information can be supplied either as precomputed external
risk scores (<code>RS</code>) or as externally derived coefficients (<code>beta</code>). The integration
strength is controlled by the tuning parameter <code>eta</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">coxkl_enet</span><span class="op">(</span></span>
<span>  <span class="va">z</span>,</span>
<span>  <span class="va">delta</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  stratum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  RS <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  lambda.min.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="va">p</span>, <span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>,</span>
<span>  lambda.early.stop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Mstop <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  max.total.iter <span class="op">=</span> <span class="op">(</span><span class="va">Mstop</span> <span class="op">*</span> <span class="va">nlambda</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,</span>
<span>  group.multiplier <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  nvar.max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,</span>
<span>  group.max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stop.loss.ratio <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  actSet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  actIter <span class="op">=</span> <span class="va">Mstop</span>,</span>
<span>  actGroupNum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  actSetRemove <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  returnX <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trace.lambda <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  data_sorted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>Numeric matrix of covariates with rows representing observations and
columns representing predictor variables. All covariates must be numeric.</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>Numeric vector of event indicators (1 = event, 0 = censored).</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Numeric vector of observed event or censoring times. No sorting
required.</p></dd>


<dt id="arg-stratum">stratum<a class="anchor" aria-label="anchor" href="#arg-stratum"></a></dt>
<dd><p>Optional numeric or factor vector defining strata.</p></dd>


<dt id="arg-rs">RS<a class="anchor" aria-label="anchor" href="#arg-rs"></a></dt>
<dd><p>Optional numeric vector or matrix of external risk scores. Length
(or number of rows) must equal the number of observations. If not supplied,
<code>beta</code> must be provided.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Optional numeric vector of external coefficients (e.g., from prior
studies). Length must equal the number of columns in <code>z</code>. Use zeros to
represent covariates without external information. If not supplied, <code>RS</code>
must be provided.</p></dd>


<dt id="arg-eta">eta<a class="anchor" aria-label="anchor" href="#arg-eta"></a></dt>
<dd><p>Numeric tuning parameter controlling the reliance on external
information. Larger values place more weight on the external source.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Elastic-net mixing parameter in \((0,1]\). When \(\alpha=1\)
the penalty is lasso.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Optional nonnegative penalty parameter(s). If a numeric vector
is supplied, the path is taken as-is. If <code>NULL</code>, a sequence is generated
using <code>nlambda</code> and <code>lambda.min.ratio</code>.</p></dd>


<dt id="arg-nlambda">nlambda<a class="anchor" aria-label="anchor" href="#arg-nlambda"></a></dt>
<dd><p>Integer number of lambda values to generate when <code>lambda</code> is
<code>NULL</code>. Default <code>100</code>.</p></dd>


<dt id="arg-lambda-min-ratio">lambda.min.ratio<a class="anchor" aria-label="anchor" href="#arg-lambda-min-ratio"></a></dt>
<dd><p>Ratio of the smallest to the largest lambda when
generating a sequence (when <code>lambda</code> is <code>NULL</code>). Default <code>1e-3</code>.</p></dd>


<dt id="arg-lambda-early-stop">lambda.early.stop<a class="anchor" aria-label="anchor" href="#arg-lambda-early-stop"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, stop traversing the lambda path
early based on convergence or screening criteria. Default <code>FALSE</code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Convergence tolerance for the optimization algorithm. Default is
<code>1e-3</code>.</p></dd>


<dt id="arg-mstop">Mstop<a class="anchor" aria-label="anchor" href="#arg-mstop"></a></dt>
<dd><p>Maximum number of iterations for the inner optimization at a
given lambda. Default is <code>1000</code>.</p></dd>


<dt id="arg-max-total-iter">max.total.iter<a class="anchor" aria-label="anchor" href="#arg-max-total-iter"></a></dt>
<dd><p>Maximum total iterations across the entire lambda path.
Default is <code>(Mstop * nlambda)</code>.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Integer vector of group indices defining group
membership of predictors for grouped penalties; use <code>0</code> to indicate
unpenalized variables.</p></dd>


<dt id="arg-group-multiplier">group.multiplier<a class="anchor" aria-label="anchor" href="#arg-group-multiplier"></a></dt>
<dd><p>A vector of values representing multiplicative factors
by which each covariate's penalty is to be multiplied. Default is a vector of 1's.</p></dd>


<dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, columns of <code>z</code> are standardized prior
to fitting, with coefficients re-scaled on output. Default <code>TRUE</code>.</p></dd>


<dt id="arg-nvar-max">nvar.max<a class="anchor" aria-label="anchor" href="#arg-nvar-max"></a></dt>
<dd><p>Integer cap on the number of active variables allowed during
fitting. Default number of predictors.</p></dd>


<dt id="arg-group-max">group.max<a class="anchor" aria-label="anchor" href="#arg-group-max"></a></dt>
<dd><p>Integer cap on the number of active groups allowed during
fitting. Default total number of groups.</p></dd>


<dt id="arg-stop-loss-ratio">stop.loss.ratio<a class="anchor" aria-label="anchor" href="#arg-stop-loss-ratio"></a></dt>
<dd><p>Relative improvement threshold for early stopping along
the path; optimization may stop if objective gain falls below this value.
Default <code>1e-3</code>.</p></dd>


<dt id="arg-actset">actSet<a class="anchor" aria-label="anchor" href="#arg-actset"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, use an active-set strategy. Default <code>TRUE</code>.</p></dd>


<dt id="arg-actiter">actIter<a class="anchor" aria-label="anchor" href="#arg-actiter"></a></dt>
<dd><p>Maximum number of active-set refinement iterations per lambda.
Default <code>Mstop</code>.</p></dd>


<dt id="arg-actgroupnum">actGroupNum<a class="anchor" aria-label="anchor" href="#arg-actgroupnum"></a></dt>
<dd><p>Maximum number of active groups allowed under the
active-set scheme.</p></dd>


<dt id="arg-actsetremove">actSetRemove<a class="anchor" aria-label="anchor" href="#arg-actsetremove"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, allow dropping variables/groups from
the active set during iterations. Default <code>FALSE</code>.</p></dd>


<dt id="arg-returnx">returnX<a class="anchor" aria-label="anchor" href="#arg-returnx"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, return standardized design and related
internals in <code>result$returnX</code>. Default <code>FALSE</code>.</p></dd>


<dt id="arg-trace-lambda">trace.lambda<a class="anchor" aria-label="anchor" href="#arg-trace-lambda"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, record path-wise traces across the
lambda sequence. Default <code>FALSE</code>.</p></dd>


<dt id="arg-message">message<a class="anchor" aria-label="anchor" href="#arg-message"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, progress messages are printed during model
fitting. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-data-sorted">data_sorted<a class="anchor" aria-label="anchor" href="#arg-data-sorted"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, input is assumed already sorted by
<code>stratum</code> then <code>time</code>. Default <code>FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"coxkl_enet"</code>, a list with components:</p><dl><dt><code>beta</code></dt>
<dd><p>Coefficient estimates (vector or matrix across the path).</p></dd>

<dt><code>group</code></dt>
<dd><p>A <code>factor</code> of the original group assignments.</p></dd>

<dt><code>lambda</code></dt>
<dd><p>The lambda value(s) used or generated.</p></dd>

<dt><code>alpha</code></dt>
<dd><p>The elastic-net mixing parameter used.</p></dd>

<dt><code>likelihood</code></dt>
<dd><p>Vector of log-partial likelihoods for each lambda.</p></dd>

<dt><code>n</code></dt>
<dd><p>Number of observations.</p></dd>

<dt><code>df</code></dt>
<dd><p>Effective degrees of freedom (e.g., number of nonzero
coefficients or group-adjusted count) along the path.</p></dd>

<dt><code>iter</code></dt>
<dd><p>Number of iterations taken (per lambda and/or total).</p></dd>

<dt><code>W</code></dt>
<dd><p>Exponentiated linear predictors on the original scale.</p></dd>

<dt><code>group.multiplier</code></dt>
<dd><p>Group-specific penalty multipliers used.</p></dd>

<dt><code>returnX</code></dt>
<dd><p>Only when <code>returnX = TRUE</code>: a list with elements
<code>XX</code> (standardization/orthogonalization info from <code>std.Z</code>),
<code>time</code>, <code>delta</code>, <code>stratum</code>, and <code>RS</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Setting <code>lambda = 0</code> reduces to the unpenalized <code><a href="coxkl.html">coxkl</a></code> model.</p>
<p>When <code>lambda &gt; 0</code>, the model fits a KL-regularized Cox objective with an
elastic-net penalty:
$$\ell_{\mathrm{KL}}(\beta;\eta) \;-\; \lambda\Big\{ \alpha\|\beta\|_1 \;+\; (1-\alpha)\tfrac{1}{2}\|\beta\|_2^2 \Big\},$$
where \(\alpha=1\) gives lasso and \(0&lt;\alpha&lt;1\) gives elastic net. Grouped
penalties are supported via <code>group</code> (use <code>0</code> for unpenalized variables), with optional
per-group scaling through <code>group.multiplier</code>. If <code>lambda</code> is <code>NULL</code>, a decreasing path
of length <code>nlambda</code> is generated using <code>lambda.min.ratio</code>; early stopping can prune the
path (<code>lambda.early.stop</code>, <code>stop.loss.ratio</code>). When <code>standardize = TRUE</code>, predictors are
standardized for fitting and coefficients are rescaled on output. If <code>data_sorted = FALSE</code>,
data are sorted by <code>stratum</code> then <code>time</code> for optimization and predictions are returned in
the original order (reported via <code>W = exp(linear predictors)</code>). An active-set scheme
(<code>actSet</code>, <code>actIter</code>, <code>nvar.max</code>, <code>group.max</code>, <code>actGroupNum</code>, <code>actSetRemove</code>) is used to
accelerate the solution along the lambda path.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="coxkl.html">coxkl</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_highdim</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">train_dat_highdim</span> <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">train</span></span></span>
<span class="r-in"><span><span class="va">beta_external_highdim</span> <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model_enet</span> <span class="op">&lt;-</span> <span class="fu">coxkl_enet</span><span class="op">(</span>z <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>                         delta <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">status</span>,</span></span>
<span class="r-in"><span>                         time <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">time</span>,</span></span>
<span class="r-in"><span>                         stratum <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                         RS <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                         beta <span class="op">=</span> <span class="va">beta_external_highdim</span>,</span></span>
<span class="r-in"><span>                         eta <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                         alpha <span class="op">=</span> <span class="fl">1.0</span>,</span></span>
<span class="r-in"><span>                         message <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> External beta information is used.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Stratum information not provided. All data is assumed to originate from a single stratum!</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yubo Shao, Lingfeng Luo, Junyi Qiu, Xiaohan Liu, Di Wang, Kevin He.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

