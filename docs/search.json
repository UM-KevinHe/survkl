[{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"Accurate prognosis prediction plays central role survival analysis. recent growth large-scale biobank studies—characterized extensive genetic, transcriptomic, imaging, electronic health record data—created new opportunities enhance prediction accuracy. However, despite potential, datasets often suffer limited effective sample sizes, high dimensionality, low signal--noise ratios, practical constraints patient privacy. Integrating external information promising strategy improving model performance, yet classical data integration methods typically assume homogeneous data-generating mechanisms across sources. assumption rarely holds modern biomedical applications. Ignoring heterogeneity can introduce substantial bias, underscoring need transfer-learning approaches explicitly account discrepancies across populations. KL divergence used previously integrating binary-outcome models, extending ideas censored time--event outcomes nontrivial due censoring limited nature available external survival information (e.g., predicted risk scores sets coefficients without baseline hazard). survkl package addresses challenges offering transfer-learning framework Cox models integrates external information newly collected survival data. designed flexible, privacy-preserving, effective across low- high-dimensional settings. Key features include:","code":""},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"key-features","dir":"Articles","previous_headings":"Introduction","what":"Key Features","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"Transfer Learning KL Integration: Incorporates various types external information via KL-based penalization adaptively borrow strength. Privacy-Preserving External Use: Requires summary-level external inputs—risk scores coefficient estimates—without access individual-level external data. Robustness Heterogeneity: Explicitly accounts population differences adaptive weighting controlled tuning parameters (eta), enabling selective borrowing compatible sources. High-Dimensional Modeling Support: Implements regularized KL-integrated Cox models, including Ridge (coxkl_ridge) Elastic Net (coxkl_enet, including LASSO special case) Flexible External Information Formats: Supports external coefficients, risk scores, partially overlapping predictor sets. Comprehensive Cross-Validation Framework: Provides multiple tuning criteria including Two based C-index Two based Loss: predicted deviance V&VH loss. vignette introduces main functionalities survkl provides examples low- high-dimensional modeling workflows.","code":""},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"can install CRAN: install development version survkl GitHub:","code":"install.packages(\"survkl\") require(devtools) require(remotes) remotes::install_github(\"UM-KevinHe/survkl\", ref = \"main\")"},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick Start","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"section provides brief overview main functions using example datasets included package. First, load package:","code":"library(survkl)"},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"low-dimensional-integration","dir":"Articles","previous_headings":"Quick Start","what":"Low-Dimensional Integration","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"low-dimensional KL-integrated Cox model, implemented coxkl, designed settings number predictors modest. method incorporates external information—either form external Cox coefficients (beta) pre-computed external risk scores (RS)—using KL-based penalization. tuning parameter eta governs degree borrowing: - eta = 0 reproduces standard Cox model; - larger eta values increasingly pull fitted coefficients toward external information. section demonstrate fit KL-integrated Cox model select optimal eta using cross-validation via cv.coxkl.","code":""},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"example-data-structure","dir":"Articles","previous_headings":"Quick Start > Low-Dimensional Integration","what":"Example data structure","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"illustrate workflow using built-low-dimensional simulated dataset: externally derived coefficients beta_external: generate sequence eta values internal utility generate_eta(), fit KL-integrated model across grid: S3 method coef() provides clean interface extract estimated coefficients. requested eta fitted values, linear interpolation performed: Users may instead supply external risk score vector: Objects class coxkl can visualized using S3 plotting method plot(). function displays model performance changes across eta–sequence used fitting. Two types performance criteria supported: \"loss\" (default; −2 × partial log-likelihood, normalized sample size) \"CIndex\" (stratified concordance index) test data supplied, performance computed using training data stored object$data:  function cv.coxkl performs K-fold (default 5) cross-validation choose integration parameter. supports four criteria: \"V&VH\" — V&VH loss \"LinPred\" — predicted partial deviance \"CIndex_pooled\" — pooled comparable pairs \"CIndex_foldaverage\" — per-fold stratified C-index example using default \"V&VH\" criterion: cross-validated performance curve can visualized using cv.plot():  solid purple curve displays cross-validated loss across different values eta. green dotted horizontal line marks internal baseline eta = 0, representing model incorporate external information. vertical dashed orange line indicates optimal eta value, cross-validated loss minimized. comparison purple curve green baseline shows whether borrowing external information improves prediction performance. Whenever purple curve falls green line, using external information (eta > 0) yields better predictive accuracy relying solely internal model.","code":"data(ExampleData_lowdim)  train  <- ExampleData_lowdim$train test   <- ExampleData_lowdim$test  z      <- train$z delta  <- train$status time   <- train$time strat  <- train$stratum beta_ext <- ExampleData_lowdim$beta_external_good eta_grid <- generate_eta(method = \"exponential\", n = 100, max_eta = 30) fit_lowdim <- coxkl(   z = z,   delta = delta,   time = time,   stratum = strat,   beta = beta_ext,   etas = eta_grid ) coef(fit_lowdim, eta = 1) ## Warning: Linear interpolation performed between eta = 0.979 and eta = 1.040 for ## eta = 1.000. ##                1 ## [1,]  0.25018459 ## [2,] -0.39555046 ## [3,]  0.08825084 ## [4,] -0.58446411 ## [5,]  0.29503025 ## [6,] -0.55443656 RS_ext <- as.matrix(z) %*% as.matrix(beta_ext)  fit_lowdim_RS <- coxkl(   z = z,   delta = delta,   time = time,   stratum = strat,   RS = RS_ext,   etas = eta_grid )  coef(fit_lowdim_RS)[1:5] ## [1]  0.25982263 -0.49599768 -0.01972113 -0.84023506  0.24808718 plot(   fit_lowdim,   test_z       = test$z,   test_time    = test$time,   test_delta   = test$status,   test_stratum = test$stratum,   criteria     = \"loss\" ) ## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ## ℹ Please use `linewidth` instead. ## ℹ The deprecated feature was likely used in the survkl package. ##   Please report the issue to the authors. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. cv_lowdim <- cv.coxkl(   z        = z,   delta    = delta,   time     = time,   stratum  = strat,   beta     = beta_ext,   etas     = eta_grid,   nfolds   = 5,   criteria = \"V&VH\",   seed = 1) cv.plot(cv_lowdim)"},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"high-dimensional-integration-ridge-elastic-net-and-lasso","dir":"Articles","previous_headings":"Quick Start","what":"High-Dimensional Integration (Ridge, Elastic Net, and LASSO)","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"high-dimensional settings (example, number predictors comparable exceeds sample size), survkl package extends KL-integrated Cox modeling regularization. Two families penalties supported: Ridge penalty (L2), implemented coxkl_ridge, shrinks coefficients toward zero retaining dense solutions. Elastic net penalty (mixture L1 L2), implemented coxkl_enet, includes LASSO (pure L1) special case mixing parameter set 1. models combine: KL term, controlled integration parameter eta, borrow information external sources (risk scores RS coefficients beta), regularization term (ridge elastic net) stabilize estimation high-dimensional designs. section first introduce shared high-dimensional example dataset, illustrate usage ridge-penalized model coxkl_ridge. (elastic net workflows analogous discussed separate subsection.)","code":""},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"high-dimensional-example-data","dir":"Articles","previous_headings":"Quick Start > High-Dimensional Integration (Ridge, Elastic Net, and LASSO)","what":"High-dimensional example data","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"use built-high-dimensional simulated dataset: dataset contains 50 predictors (Z1–Z50) 6 signal variables 44 AR(1) noise variables. Externally derived coefficients provided beta_external: external coefficients estimated separate dataset using Z1–Z6 expanded length-50 vector, zeros Z7–Z50.","code":"data(ExampleData_highdim)  train_hd  <- ExampleData_highdim$train test_hd   <- ExampleData_highdim$test  z_hd      <- train_hd$z delta_hd  <- train_hd$status time_hd   <- train_hd$time strat_hd  <- train_hd$stratum beta_external_hd <- ExampleData_highdim$beta_external"},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"ridge-penalized-kl-integrated-cox-model-coxkl_ridge","dir":"Articles","previous_headings":"Quick Start > High-Dimensional Integration (Ridge, Elastic Net, and LASSO)","what":"Ridge-Penalized KL-Integrated Cox Model (coxkl_ridge)","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"function coxkl_ridge fits KL-integrated Cox model ridge (L2) penalty predictors. External information incorporated KL term weighted eta (user-specified scalar), ridge penalty controlled sequence tuning parameters lambda. lambda provided, decreasing lambda path generated automatically. first fit KL–ridge model fixed integration weight eta automatically generated lambda path: fitted object stores, lambda value: model_ridge$lambda — lambda sequence (decreasing order), model_ridge$beta — estimated coefficients (one column per lambda), model_ridge$linear.predictors — linear predictors observations lambda values, model_ridge$likelihood — partial log-likelihood along lambda path, model_ridge$data — data used fitting. S3 method coef() extracts estimated coefficients: focus specific value lambda: requested lambda exactly one fitted values, coef() performs linear interpolation along lambda path. Objects class coxkl_ridge can visualized using S3 plotting method plot(): default, plots (given eta): Loss (-2 * partial log-likelihood) versus penalty parameter lambda, x-axis reversed log10 scale (larger penalties left, smaller penalties right), y-axis labeled “Loss”. vertical dashed orange line marks optimal value λ, loss reaches minimum evaluated grid.  function cv.coxkl_ridge performs K-fold cross-validation tune integration parameter eta internally scanning lambda path candidate eta. eta, : evaluates sequence ridge penalties lambda, computes chosen cross-validation criterion held-folds, selects best lambda eta, aggregates results summary tables. Supported criteria : \"V&VH\" — V&VH loss (reported Loss = -2 * score), \"LinPred\" — predicted partial deviance, \"CIndex_pooled\" — pooled C-index folds, \"CIndex_foldaverage\" — average C-index across folds. Example: tuning eta using 5-fold cross-validation \"V&VH\" criterion: best lambda eta (according chosen criterion) provided : low-dimensional models, helper function cv.plot() can used visualize performance versus eta:  plot shows: purple curve cross-validated performance across eta sequence (loss C-index), green dotted horizontal line indicating internal baseline eta = 0, green point marking baseline value, vertical dashed orange line indicating optimal η, cross-validated loss reaches minimum.","code":"model_ridge <- coxkl_ridge(   z        = z_hd,   delta    = delta_hd,   time     = time_hd,   stratum  = strat_hd,   beta     = beta_external_hd,   # external coefficients (length 50)   eta      = 1                  # KL integration weight ) # All lambdas (columns ordered in decreasing lambda) coef(model_ridge)[1:5, 1:5]  # first 5 lambdas ##          82.0989     74.8055     68.1599     62.1048     56.5876 ## [1,]  0.03940019  0.04317345  0.04718185  0.05142086  0.05588316 ## [2,] -0.08703965 -0.09270340 -0.09863286 -0.10483116 -0.11129985 ## [3,]  0.04654658  0.05031996  0.05434817  0.05864173  0.06321089 ## [4,] -0.05680339 -0.06147303 -0.06646655 -0.07179722 -0.07747730 ## [5,]  0.10912724  0.11518227  0.12137484  0.12769148  0.13411779 lambda_target <- model_ridge$lambda[5] coef(model_ridge, lambda = lambda_target)[1:5] ## [1]  0.05588316 -0.11129985  0.06321089 -0.07747730  0.13411779 plot(   model_ridge,   test_z       = test_hd$z,   test_time    = test_hd$time,   test_delta   = test_hd$status,   test_stratum = test_hd$stratum,   criteria     = \"CIndex\" ) eta_grid_hd <- generate_eta(method = \"exponential\", n = 50, max_eta = 100)  cv_ridge_hd <- cv.coxkl_ridge(   z           = z_hd,   delta       = delta_hd,   time        = time_hd,   stratum     = strat_hd,   beta        = beta_external_hd,   etas        = eta_grid_hd,   nfolds      = 5,   cv.criteria = \"V&VH\",   seed = 1) cv_ridge_hd$integrated_stat.best_per_eta ##             eta       lambda     Loss ## 1    0.00000000 1.025724e+02 2.821608 ## 2    0.09953651 9.834014e+01 2.818411 ## 3    0.20888146 9.449421e+01 2.815652 ## 4    0.32900138 7.554877e+01 2.813131 ## 5    0.46095806 5.515441e+01 2.810267 ## 6    0.60591790 4.034998e+01 2.806921 ## 7    0.76516225 2.957942e+01 2.803008 ## 8    0.94009872 2.029238e+01 2.798498 ## 9    1.13227362 1.545093e+01 2.793370 ## 10   1.34338567 1.071272e+01 2.787729 ## 11   1.57530093 7.423356e+00 2.781748 ## 12   1.83006939 5.642671e+00 2.775576 ## 13   2.10994303 3.906313e+00 2.769394 ## 14   2.41739573 2.703155e+00 2.763368 ## 15   2.75514517 1.869880e+00 2.757622 ## 16   3.12617683 1.293037e+00 2.752276 ## 17   3.53377037 7.421110e-01 2.747417 ## 18   3.98152865 3.879752e-01 2.743117 ## 19   4.47340953 1.057312e-01 2.739418 ## 20   5.01376093 8.595137e-03 2.736400 ## 21   5.60735916 8.612383e-03 2.734238 ## 22   6.25945124 8.628077e-03 2.732777 ## 23   6.97580122 8.642360e-03 2.731864 ## 24   7.76274115 8.655359e-03 2.731377 ## 25   8.62722703 8.667188e-03 2.731219 ## 26   9.57690034 8.677955e-03 2.731312 ## 27  10.62015555 8.687754e-03 2.731591 ## 28  11.76621431 8.696673e-03 2.732009 ## 29  13.02520701 8.704790e-03 2.732525 ## 30  14.40826229 8.712178e-03 2.733107 ## 31  15.92760542 8.718903e-03 2.733730 ## 32  17.59666636 8.725024e-03 2.734376 ## 33  19.43019846 8.730595e-03 2.735029 ## 34  21.44440891 8.735666e-03 2.735677 ## 35  23.65710197 8.740282e-03 2.736313 ## 36  26.08783632 8.744483e-03 2.736929 ## 37  28.75809801 8.748307e-03 2.737521 ## 38  31.69149033 8.751788e-03 2.738086 ## 39  34.91394249 8.754956e-03 2.738622 ## 40  38.45393876 8.757841e-03 2.739128 ## 41  42.34277030 8.760466e-03 2.739603 ## 42  46.61481175 8.762856e-03 2.740048 ## 43  51.30782504 8.765031e-03 2.740464 ## 44  56.46329322 8.767011e-03 2.740851 ## 45  62.12678712 8.768813e-03 2.741211 ## 46  68.34836818 8.770454e-03 2.741544 ## 47  75.18303094 8.771947e-03 2.741852 ## 48  82.69118918 8.773307e-03 2.742137 ## 49  90.93920990 8.774544e-03 2.742399 ## 50 100.00000000 8.775671e-03 2.742641 cv.plot(cv_ridge_hd)"},{"path":"https://um-kevinhe.github.io/survkl/articles/survkl.html","id":"elastic-net-lasso-kl-integrated-cox-model-coxkl_enet","dir":"Articles","previous_headings":"Quick Start > High-Dimensional Integration (Ridge, Elastic Net, and LASSO)","what":"Elastic-Net / LASSO KL-Integrated Cox Model (coxkl_enet)","title":"survkl: Transfer-Learning Based Integrated Cox Models","text":"function coxkl_enet fits KL-integrated Cox model elastic-net penalty, controlled mixing parameter alpha. alpha = 1, penalty reduces LASSO, enabling coefficient sparsity addition KL-based integration external information. External knowledge may incorporated either external coefficients (beta) externally computed risk score (RS). integration weight eta determines strongly model borrows external signal, penalty parameter lambda controls sparsity level. lambda supplied, function automatically generates decreasing lambda sequence. illustrate workflow using LASSO (alpha = 1) automatically generated lambda path: fitted object stores, lambda value: model_enet$lambda — lambda sequence (decreasing order), model_enet$beta — estimated coefficients (one column per lambda), model_enet$likelihood — partial log-likelihood along lambda path, model_enet$data — data used fitting. S3 method coef() extracts estimated coefficients: extract coefficients corresponding specific lambda: Objects class coxkl_enet can visualized using S3 method plot(), default plot loss versus lambda:  Similar, function cv.coxkl_enet extends fitting procedure performing K-fold cross-validation supplied grid eta values: CV results can visualized using cv.plot():","code":"model_enet <- coxkl_enet(   z        = z_hd,   delta    = delta_hd,   time     = time_hd,   stratum  = strat_hd,   beta     = beta_external_hd,      eta      = 1,                    alpha    = 1                  # LASSO penalty ) coef(model_enet)[1:5, 1:5] ##    0.0853     0.0796     0.0742     0.0692     0.0645 ## Z1      0 0.00000000 0.00000000 0.00000000 0.00000000 ## Z2      0 0.00000000 0.00000000 0.00000000 0.00000000 ## Z3      0 0.00000000 0.00000000 0.00000000 0.00000000 ## Z4      0 0.00000000 0.00000000 0.00000000 0.00000000 ## Z5      0 0.01945713 0.03849402 0.05620049 0.07282693 lambda_target <- model_enet$lambda[5] coef(model_enet, lambda = lambda_target)[1:5] ## [1] 0.00000000 0.00000000 0.00000000 0.00000000 0.07282693 plot(   model_enet,   test_z = test_hd$z,   test_time = test_hd$time,   test_delta = test_hd$status,   test_stratum = test_hd$stratum,   criteria = \"loss\" ) eta_grid_hd <- generate_eta(method = \"exponential\",                             n = 50,                             max_eta = 100)  cv_enet_hd <- cv.coxkl_enet(   z = z_hd,   delta = delta_hd,   time = time_hd,   stratum = strat_hd,   beta = beta_external_hd,   etas = eta_grid_hd,   alpha = 1, # LASSO   nfolds = 5,   cv.criteria = \"V&VH\",   seed = 1 ) cv.plot(cv_enet_hd)"},{"path":"https://um-kevinhe.github.io/survkl/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yubo Shao. Author, maintainer. Lingfeng Luo. Author. Xiaohan Liu. Author. Junyi Qiu. Author. Di Wang. Author. Kevin . Author.","code":""},{"path":"https://um-kevinhe.github.io/survkl/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Shao Y, Luo L, Liu X, Qiu J, Wang D, K (2025). survkl: Estimate Survival Data Data Intergration. R package version 1.0.0, https://um-kevinhe.github.io/survkl/.","code":"@Manual{,   title = {survkl: Estimate Survival Data with Data Intergration},   author = {Yubo Shao and Lingfeng Luo and Xiaohan Liu and Junyi Qiu and Di Wang and Kevin He},   year = {2025},   note = {R package version 1.0.0},   url = {https://um-kevinhe.github.io/survkl/}, }"},{"path":"https://um-kevinhe.github.io/survkl/index.html","id":"survkl-an-r-package-for-transfer-learningbased-integrated-cox-models","dir":"","previous_headings":"","what":"Estimate Survival Data with Data Intergration","title":"Estimate Survival Data with Data Intergration","text":"survkl provides flexible efficient tools integrating external risk scores Cox proportional hazards models accounting population heterogeneity. package enables robust estimation, improved predictive accuracy, user-friendly workflows modern survival analysis.","code":""},{"path":"https://um-kevinhe.github.io/survkl/index.html","id":"key-features","dir":"","previous_headings":"","what":"Key Features","title":"Estimate Survival Data with Data Intergration","text":"Integration External Risk Scores Seamlessly incorporate predictions external risk model (e.g., polygenic hazard scores, deep-learning–based risk scores). Population Heterogeneity Adjustment Corrects distributional differences external model’s training population study population. Efficient Computation Designed high-dimensional large-scale survival datasets. Improved Estimation Prediction Demonstrated gains estimation efficiency predictive accuracy. Built-Cross-Validation Automated selection tuning penalization parameters.","code":""},{"path":"https://um-kevinhe.github.io/survkl/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimate Survival Data with Data Intergration","text":"Note: package active development. Please report issues encounter. Requires R ≥ 4.0.0. Install CRAN: install development version GitHub:","code":"install.packages(\"survkl\") require(\"devtools\") require(\"remotes\") remotes::install_github(\"UM-KevinHe/survkl\")"},{"path":"https://um-kevinhe.github.io/survkl/index.html","id":"detailed-tutorial","dir":"","previous_headings":"","what":"Detailed Tutorial","title":"Estimate Survival Data with Data Intergration","text":"Full package documentation parameter explanations: ","code":""},{"path":"https://um-kevinhe.github.io/survkl/index.html","id":"getting-help","dir":"","previous_headings":"","what":"Getting Help","title":"Estimate Survival Data with Data Intergration","text":"encounter problems bugs, please contact us: ybshao@umich.edu lfluo@umich.edu xhliuu@umich.edu junyiqiu@umich.edu kevinhe@umich.edu","code":""},{"path":"https://um-kevinhe.github.io/survkl/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Estimate Survival Data with Data Intergration","text":"Wang, D., Ye, W., Zhu, J., Xu, G., Tang, W., Zawistowski, M., Fritsche, L. G., & , K. (2023). Incorporating external risk information Cox model population heterogeneity: Applications trans-ancestry polygenic hazard scores. arXiv:2302.11123. Luo, L., Taylor, J. M. G., Wang, D., & , K. (2024). Flexible Deep Learning Techniques Cox Models Data Integration.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cal_surv_prob.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Survival Probabilities — cal_surv_prob","title":"Calculate Survival Probabilities — cal_surv_prob","text":"Computes individual survival probabilities fitted linear predictor z%*%beta using stratified Breslow-type baseline hazard estimate.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cal_surv_prob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Survival Probabilities — cal_surv_prob","text":"","code":"cal_surv_prob(z, delta, time, beta, stratum)"},{"path":"https://um-kevinhe.github.io/survkl/reference/cal_surv_prob.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Survival Probabilities — cal_surv_prob","text":"z numeric matrix (data frame coercible matrix) covariates. row observation column predictor. delta numeric vector event indicators (1 = event, 0 = censored). time numeric vector observed times (event censoring). beta numeric vector regression coefficients length equal number columns z. stratum optional vector specifying stratum observation. missing, single-stratum model assumed.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cal_surv_prob.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Survival Probabilities — cal_surv_prob","text":"numeric matrix survival probabilities nrow(z) rows length(time) columns. Rows correspond observations; columns internal sorted order (stratum, time) (.e., collapsed unique event times). Entry S[, j] estimated survival probability subject evaluated j-th sorted time point.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cal_surv_prob.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Survival Probabilities — cal_surv_prob","text":"Inputs internally sorted stratum time. Within stratum, baseline hazard increment computed delta/S0, S0 risk set sum returned ddloglik_S0. stratified baseline cumulative hazard Lambda0 formed cumulative sum within stratum, individual survival curves computed S(t) = exp(-Lambda0(t) * exp(z %*% beta)).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Coefficients from a coxkl Object — coef.coxkl","title":"Extract Coefficients from a coxkl Object — coef.coxkl","text":"Extracts estimated regression coefficients (beta) fitted coxkl object. Optionally, value (vector) eta can supplied. requested eta values fitted sequence, linear interpolation performed nearest neighboring eta values; --range requests error.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Coefficients from a coxkl Object — coef.coxkl","text":"","code":"# S3 method for class 'coxkl' coef(object, eta = NULL, ...)"},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Coefficients from a coxkl Object — coef.coxkl","text":"object object class \"coxkl\", typically result coxkl. eta Optional numeric value vector specifying \\(\\eta\\) values extract (interpolate) coefficients. NULL, estimated coefficients returned. ... Additional arguments (currently ignored).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Coefficients from a coxkl Object — coef.coxkl","text":"numeric matrix regression coefficients. column corresponds one value eta, sorted ascending order.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Coefficients from a coxkl Object — coef.coxkl","text":"","code":"data(ExampleData_lowdim)  train_dat_lowdim <- ExampleData_lowdim$train beta_external_good_lowdim <- ExampleData_lowdim$beta_external_good eta_list <- generate_eta(method = \"exponential\", n = 5, max_eta = 5)  model <- coxkl(z = train_dat_lowdim$z,                delta = train_dat_lowdim$status,                time = train_dat_lowdim$time,                stratum = train_dat_lowdim$stratum,                beta = beta_external_good_lowdim,                etas = eta_list) coef(model) #>                0       0.1092      0.4545     1.5466          5 #> [1,]  0.25982263  0.257655537  0.25342872  0.2484849  0.2452363 #> [2,] -0.49599768 -0.474154973 -0.43022578 -0.3771785 -0.3419523 #> [3,] -0.01972113  0.002327028  0.04893181  0.1101809  0.1549244 #> [4,] -0.84023506 -0.788594162 -0.67862767 -0.5311457 -0.4199306 #> [5,]  0.24808718  0.258493491  0.27915167  0.3031994  0.3181155 #> [6,] -0.78551866 -0.738669998 -0.63932919 -0.5063335 -0.4057148"},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_enet.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Coefficients from a coxkl_enet Object — coef.coxkl_enet","title":"Extract Coefficients from a coxkl_enet Object — coef.coxkl_enet","text":"Extracts estimated regression coefficients (beta) fitted coxkl_enet object. Optionally, one lambda values can supplied. requested lambda values fitted sequence, linear interpolation performed nearest neighbors; --range requests error.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_enet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Coefficients from a coxkl_enet Object — coef.coxkl_enet","text":"","code":"# S3 method for class 'coxkl_enet' coef(object, lambda = NULL, ...)"},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_enet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Coefficients from a coxkl_enet Object — coef.coxkl_enet","text":"object object class \"coxkl_enet\", typically result coxkl_enet. lambda Optional numeric value vector specifying regularization parameter(s) extract (interpolate) coefficients. NULL, estimated coefficients returned. ... Additional arguments (currently ignored).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_enet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Coefficients from a coxkl_enet Object — coef.coxkl_enet","text":"numeric matrix regression coefficients; column corresponds one value lambda, sorted descending order.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_enet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Coefficients from a coxkl_enet Object — coef.coxkl_enet","text":"","code":"data(ExampleData_highdim)  train_dat_highdim <- ExampleData_highdim$train beta_external_highdim <- ExampleData_highdim$beta_external   enet_model <- coxkl_enet(z = train_dat_highdim$z,                          delta = train_dat_highdim$status,                          time = train_dat_highdim$time,                          beta = beta_external_highdim,                          eta = 1,                          alpha = 1.0) coef(enet_model)[1:5, 1:10] #>    0.0853     0.0796     0.0742     0.0692     0.0645     0.0602       0.0561 #> Z1      0 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  0.000000000 #> Z2      0 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 -0.009001751 #> Z3      0 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  0.000000000 #> Z4      0 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 -0.009194676 #> Z5      0 0.01945713 0.03849402 0.05620049 0.07282693 0.08844987  0.101159122 #>         0.0523      0.0488       0.0455 #> Z1  0.00000000  0.00000000  0.000000000 #> Z2 -0.02004127 -0.02981263 -0.038485677 #> Z3  0.00000000  0.00000000  0.005058644 #> Z4 -0.03565942 -0.06036793 -0.083632736 #> Z5  0.11223900  0.12286450  0.132785714"},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_ridge.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Coefficients from a coxkl_ridge Object — coef.coxkl_ridge","title":"Extract Coefficients from a coxkl_ridge Object — coef.coxkl_ridge","text":"Extracts estimated regression coefficients (beta) fitted coxkl_ridge object. Optionally, one lambda values can supplied. requested lambda values fitted sequence, linear interpolation performed nearest neighbors; --range requests error.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_ridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Coefficients from a coxkl_ridge Object — coef.coxkl_ridge","text":"","code":"# S3 method for class 'coxkl_ridge' coef(object, lambda = NULL, ...)"},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_ridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Coefficients from a coxkl_ridge Object — coef.coxkl_ridge","text":"object object class \"coxkl_ridge\", typically result coxkl_ridge. lambda Optional numeric value vector specifying regularization parameter(s) extract (interpolate) coefficients. NULL, estimated coefficients returned. ... Additional arguments (currently ignored).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_ridge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Coefficients from a coxkl_ridge Object — coef.coxkl_ridge","text":"numeric matrix regression coefficients. column corresponds one value lambda, sorted descending order.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coef.coxkl_ridge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Coefficients from a coxkl_ridge Object — coef.coxkl_ridge","text":"","code":"data(ExampleData_highdim)   train_dat_highdim <- ExampleData_highdim$train beta_external_highdim <- ExampleData_highdim$beta_external  model_ridge <- coxkl_ridge(z = train_dat_highdim$z,                            delta = train_dat_highdim$status,                            time = train_dat_highdim$time,                            beta = beta_external_highdim,                            eta = 1) #> Warning: Stratum information not provided. All data is assumed to originate from a single stratum! coef(model_ridge)[1:5, 1:10] #>          82.0989     74.8055     68.1599     62.1048     56.5876     51.5605 #> [1,]  0.03940019  0.04317345  0.04718185  0.05142086  0.05588316  0.06055855 #> [2,] -0.08703965 -0.09270340 -0.09863286 -0.10483116 -0.11129985 -0.11803870 #> [3,]  0.04654658  0.05031996  0.05434817  0.05864173  0.06321089  0.06806550 #> [4,] -0.05680339 -0.06147303 -0.06646655 -0.07179722 -0.07747730 -0.08351777 #> [5,]  0.10912724  0.11518227  0.12137484  0.12769148  0.13411779  0.14063857 #>            46.98     42.8064     39.0036     35.5387 #> [1,]  0.06543395  0.07049345  0.07571841  0.08108773 #> [2,] -0.12504531 -0.13231486 -0.13983987 -0.14760999 #> [3,]  0.07321496  0.07866810  0.08443310  0.09051738 #> [4,] -0.08992804 -0.09671563 -0.10388587 -0.11144168 #> [5,]  0.14723786  0.15389915  0.16060546  0.16733947"},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl.html","id":null,"dir":"Reference","previous_headings":"","what":"Cox Proportional Hazards Model with KL Divergence for Data Integration — coxkl","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration — coxkl","text":"Fits Cox proportional hazards model incorporates external information via Kullback–Leibler (KL) divergence penalty. External information can supplied either external risk scores (RS) external coefficients (beta). tuning parameter(s) etas control strength integration.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration — coxkl","text":"","code":"coxkl(   z,   delta,   time,   stratum = NULL,   RS = NULL,   beta = NULL,   etas,   tol = 1e-04,   Mstop = 100,   backtrack = FALSE,   message = FALSE,   data_sorted = FALSE,   beta_initial = NULL )"},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration — coxkl","text":"z Numeric matrix covariates rows representing observations columns representing predictor variables. covariates must numeric. delta Numeric vector event indicators (1 = event, 0 = censored). time Numeric vector observed event censoring times. sorting required. stratum Optional numeric factor vector defining strata. RS Optional numeric vector matrix external risk scores. Length (number rows) must equal number observations. supplied, beta must provided. beta Optional numeric vector external coefficients (e.g., prior studies). Length must equal number columns z. Use zeros represent covariates without external information. supplied, RS must provided. etas Numeric vector tuning parameters controlling reliance external information. Larger values place weight external source. tol Convergence tolerance optimization algorithm. Default 1e-4. Mstop Maximum number iterations optimization algorithm. Default 100. backtrack Logical; TRUE, backtracking line search applied optimization. Default FALSE. message Logical; TRUE, progress messages printed model fitting. Default FALSE. data_sorted Logical; TRUE, input data assumed already sorted stratum time. Default FALSE. beta_initial Optional numeric vector length p giving starting value first eta. NULL, zero vector used.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration — coxkl","text":"object class \"coxkl\" containing: eta: fitted \\(\\eta\\) sequence. beta: estimated coefficient matrix (\\(p \\times |\\eta|\\)). linear.predictors: matrix linear predictors. likelihood: vector partial likelihoods. data: list containing input data used fitting (z, time, delta, stratum, data_sorted).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration — coxkl","text":"beta supplied (length ncol(z)), external risk scores computed internally RS = z %*% beta. RS supplied, used directly. Data optionally sorted stratum (single stratum NULL) increasing time data_sorted = FALSE. Estimation proceeds sorted data, returned linear.predictors mapped back original order. Optimization uses warm starts across (ascending) etas grid supports backtracking line search backtrack = TRUE. Internally, routine computes stratum-wise adjusted event indicator (delta_tilde) maximizes KL-regularized partial likelihood. current implementation fixes lambda = 0 low-level optimizer exposes etas primary tuning control.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration — coxkl","text":"","code":"data(ExampleData_lowdim)  train_dat_lowdim <- ExampleData_lowdim$train beta_external_good_lowdim <- ExampleData_lowdim$beta_external_good eta_list <- generate_eta(method = \"exponential\", n = 10, max_eta = 5)  model <- coxkl(z = train_dat_lowdim$z,                delta = train_dat_lowdim$status,                time = train_dat_lowdim$time,                stratum = train_dat_lowdim$stratum,                beta = beta_external_good_lowdim,                etas = eta_list)"},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_enet.html","id":null,"dir":"Reference","previous_headings":"","what":"Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso & Elastic Net Penalty — coxkl_enet","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso & Elastic Net Penalty — coxkl_enet","text":"Fits Cox proportional hazards model incorporates external information using Kullback–Leibler (KL) divergence, optional L1 (Lasso) elastic net penalty coefficients. External information can supplied either precomputed external risk scores (RS) externally derived coefficients (beta). integration strength controlled tuning parameter eta.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_enet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso & Elastic Net Penalty — coxkl_enet","text":"","code":"coxkl_enet(   z,   delta,   time,   stratum = NULL,   RS = NULL,   beta = NULL,   eta = NULL,   alpha = NULL,   lambda = NULL,   nlambda = 100,   lambda.min.ratio = ifelse(n < p, 0.05, 0.001),   lambda.early.stop = FALSE,   tol = 1e-04,   Mstop = 1000,   max.total.iter = (Mstop * nlambda),   group = 1:ncol(z),   group.multiplier = NULL,   standardize = T,   nvar.max = ncol(z),   group.max = length(unique(group)),   stop.loss.ratio = 0.001,   actSet = TRUE,   actIter = Mstop,   actGroupNum = sum(unique(group) != 0),   actSetRemove = F,   returnX = FALSE,   trace.lambda = FALSE,   message = FALSE,   data_sorted = FALSE,   ... )"},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_enet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso & Elastic Net Penalty — coxkl_enet","text":"z Numeric matrix covariates rows representing observations columns representing predictor variables. covariates must numeric. delta Numeric vector event indicators (1 = event, 0 = censored). time Numeric vector observed event censoring times. sorting required. stratum Optional numeric factor vector defining strata. RS Optional numeric vector matrix external risk scores. Length (number rows) must equal number observations. supplied, beta must provided. beta Optional numeric vector external coefficients (e.g., prior studies). Length must equal number columns z. Use zeros represent covariates without external information. supplied, RS must provided. eta Numeric tuning parameter controlling reliance external information. Larger values place weight external source. alpha Elastic-net mixing parameter \\((0,1]\\). \\(\\alpha=1\\) penalty lasso. lambda Optional nonnegative penalty parameter(s). numeric vector supplied, path taken -. NULL, sequence generated using nlambda lambda.min.ratio. nlambda Integer number lambda values generate lambda NULL. Default 100. lambda.min.ratio Ratio smallest largest lambda generating sequence (lambda NULL). Default 1e-3. lambda.early.stop Logical; TRUE, stop traversing lambda path early based convergence screening criteria. Default FALSE. tol Convergence tolerance optimization algorithm. Default 1e-3. Mstop Maximum number iterations inner optimization given lambda. Default 1000. max.total.iter Maximum total iterations across entire lambda path. Default (Mstop * nlambda). group Integer vector group indices defining group membership predictors grouped penalties; use 0 indicate unpenalized variables. group.multiplier vector values representing multiplicative factors covariate's penalty multiplied. Default vector 1's. standardize Logical; TRUE, columns z standardized prior fitting, coefficients re-scaled output. Default TRUE. nvar.max Integer cap number active variables allowed fitting. Default number predictors. group.max Integer cap number active groups allowed fitting. Default total number groups. stop.loss.ratio Relative improvement threshold early stopping along path; optimization may stop objective gain falls value. Default 1e-3. actSet Logical; TRUE, use active-set strategy. Default TRUE. actIter Maximum number active-set refinement iterations per lambda. Default Mstop. actGroupNum Maximum number active groups allowed active-set scheme. actSetRemove Logical; TRUE, allow dropping variables/groups active set iterations. Default FALSE. returnX Logical; TRUE, return standardized design related internals result$returnX. Default FALSE. trace.lambda Logical; TRUE, record path-wise traces across lambda sequence. Default FALSE. message Logical; TRUE, progress messages printed model fitting. Default FALSE. data_sorted Logical; TRUE, input assumed already sorted stratum time. Default FALSE. ... Additional arguments.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_enet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso & Elastic Net Penalty — coxkl_enet","text":"object class \"coxkl_enet\", list components: beta Coefficient estimates (vector matrix across path). group factor original group assignments. lambda lambda value(s) used generated. alpha elastic-net mixing parameter used. likelihood Vector log-partial likelihoods lambda. n Number observations. df Effective degrees freedom (e.g., number nonzero coefficients group-adjusted count) along path. iter Number iterations taken (per lambda /total). W Exponentiated linear predictors original scale. group.multiplier Group-specific penalty multipliers used. returnX returnX = TRUE: list elements XX (standardization/orthogonalization info std.Z), time, delta, stratum, RS.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_enet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso & Elastic Net Penalty — coxkl_enet","text":"Setting lambda = 0 reduces unpenalized coxkl model. lambda > 0, model fits KL-regularized Cox objective elastic-net penalty: $$\\ell_{\\mathrm{KL}}(\\beta;\\eta) \\;-\\; \\lambda\\Big\\{ \\alpha\\|\\beta\\|_1 \\;+\\; (1-\\alpha)\\tfrac{1}{2}\\|\\beta\\|_2^2 \\Big\\},$$ \\(\\alpha=1\\) gives lasso \\(0<\\alpha<1\\) gives elastic net. Grouped penalties supported via group (use 0 unpenalized variables), optional per-group scaling group.multiplier. lambda NULL, decreasing path length nlambda generated using lambda.min.ratio; early stopping can prune path (lambda.early.stop, stop.loss.ratio). standardize = TRUE, predictors standardized fitting coefficients rescaled output. data_sorted = FALSE, data sorted stratum time optimization predictions returned original order (reported via W = exp(linear predictors)). active-set scheme (actSet, actIter, nvar.max, group.max, actGroupNum, actSetRemove) used accelerate solution along lambda path.","code":""},{"path":[]},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_enet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cox Proportional Hazards Model with KL Divergence for Data Integration and Lasso & Elastic Net Penalty — coxkl_enet","text":"","code":"data(ExampleData_highdim)   train_dat_highdim <- ExampleData_highdim$train beta_external_highdim <- ExampleData_highdim$beta_external  model_enet <- coxkl_enet(z = train_dat_highdim$z,                          delta = train_dat_highdim$status,                          time = train_dat_highdim$time,                          beta = beta_external_highdim,                          eta = 0,                          alpha = 1.0)"},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_ridge.html","id":null,"dir":"Reference","previous_headings":"","what":"Cox Proportional Hazards Model with Ridge Penalty and External Information — coxkl_ridge","title":"Cox Proportional Hazards Model with Ridge Penalty and External Information — coxkl_ridge","text":"Fits Cox proportional hazards model using ridge-type penalty (L2) covariates. model can integrate external information either precomputed risk scores (RS) externally supplied coefficients (beta). tuning parameter eta controls relative weight external information. lambda provided, lambda sequence automatically generated.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_ridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cox Proportional Hazards Model with Ridge Penalty and External Information — coxkl_ridge","text":"","code":"coxkl_ridge(   z,   delta,   time,   stratum = NULL,   RS = NULL,   beta = NULL,   eta = NULL,   lambda = NULL,   nlambda = 100,   lambda.min.ratio = ifelse(n_obs < n_vars, 0.01, 1e-04),   penalty.factor = 0.999,   tol = 1e-04,   Mstop = 50,   backtrack = FALSE,   message = FALSE,   data_sorted = FALSE,   beta_initial = NULL,   ... )"},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_ridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cox Proportional Hazards Model with Ridge Penalty and External Information — coxkl_ridge","text":"z Numeric matrix covariates (observations rows, predictors columns). delta Numeric vector event indicators (1 = event, 0 = censored). time Numeric vector observed times. stratum Optional numeric factor vector specifying strata. RS Optional numeric vector matrix external risk scores. beta Optional numeric vector externally derived coefficients. eta Non-negative scalar controlling strength external information. lambda Optional numeric scalar vector penalty parameters. NULL, sequence generated automatically. nlambda Number lambda values generate lambda NULL. lambda.min.ratio Ratio defining minimum lambda relative lambda.max. penalty.factor Numeric scalar [0, 1). Controls overall strength penalty generating ridge regression lambda sequence. Smaller values correspond stronger penalization. used lambda = NULL. tol Convergence tolerance iterative estimation algorithm. Mstop Maximum number iterations estimation. backtrack Logical; TRUE, uses backtracking line search. message Logical; TRUE, progress messages printed model fitting. Default FALSE. data_sorted Logical; TRUE, assumes input data already sorted strata time. beta_initial Optional; default NULL. NULL, algorithm initializes beta_initial zero vector warm start ... Additional arguments.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_ridge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cox Proportional Hazards Model with Ridge Penalty and External Information — coxkl_ridge","text":"object class \"coxkl_ridge\" containing: lambda: lambda sequence used estimation. beta: Matrix estimated coefficients lambda. linear.predictors: Matrix linear predictors. likelihood: Vector log-partial likelihoods. data: list containing input data used fitting (z, time, delta, stratum, data_sorted).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_ridge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cox Proportional Hazards Model with Ridge Penalty and External Information — coxkl_ridge","text":"estimator maximizes KL-regularized Cox partial log-likelihood ridge (L2) penalty coefficients. External information incorporated via KL term weighted eta: beta supplied (length ncol(z)), external risk scores computed internally RS = z %*% beta; otherwise RS must provided. lambda NULL, decreasing lambda path length nlambda generated using lambda.min.ratio (overall scale influenced penalty.factor). Optimization proceeds along lambda path warm starts (re-using previous solution beta_initial); beta_initial = NULL, first step uses zeros. data_sorted = FALSE, data sorted stratum time fitting returned linear predictors mapped back original observation order. tol, Mstop, backtrack control convergence line search.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/coxkl_ridge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cox Proportional Hazards Model with Ridge Penalty and External Information — coxkl_ridge","text":"","code":"data(ExampleData_highdim)   train_dat_highdim <- ExampleData_highdim$train beta_external_highdim <- ExampleData_highdim$beta_external  model_ridge <- coxkl_ridge(z = train_dat_highdim$z,                            delta = train_dat_highdim$status,                            time = train_dat_highdim$time,                            beta = beta_external_highdim) #> Warning: eta is not provided. Setting eta = 0 (no external information used). #> Warning: Stratum information not provided. All data is assumed to originate from a single stratum!"},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-Validated Selection of Integration Parameter （eta） for the Cox–KL Model — cv.coxkl","title":"Cross-Validated Selection of Integration Parameter （eta） for the Cox–KL Model — cv.coxkl","text":"Performs K-fold cross-validation select integration parameter eta Cox–KL model. fold fits model training split evaluates held-split using specified performance criterion.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-Validated Selection of Integration Parameter （eta） for the Cox–KL Model — cv.coxkl","text":"","code":"cv.coxkl(   z,   delta,   time,   stratum = NULL,   RS = NULL,   beta = NULL,   etas = NULL,   tol = 1e-04,   Mstop = 100,   backtrack = FALSE,   nfolds = 5,   criteria = c(\"V&VH\", \"LinPred\", \"CIndex_pooled\", \"CIndex_foldaverage\"),   c_index_stratum = NULL,   message = FALSE,   seed = NULL,   ... )"},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-Validated Selection of Integration Parameter （eta） for the Cox–KL Model — cv.coxkl","text":"z Numeric matrix covariates (rows = observations, columns = variables). delta Numeric vector event indicators (1 = event, 0 = censored). time Numeric vector observed event censoring times. stratum Optional numeric factor vector defining strata. NULL, observations treated single stratum. RS Optional numeric vector matrix external risk scores. omitted, beta must supplied. beta Optional numeric vector external coefficients. omitted, RS must supplied. etas Numeric vector candidate tuning values cross-validated. (required). Values internally sorted ascending order. tol Convergence tolerance optimizer used inside coxkl. Default 1e-4. Mstop Maximum number Newton iterations used inside coxkl. Default 100. backtrack Logical; TRUE, backtracking line search applied optimization. Default FALSE. nfolds Number cross-validation folds. Default 5. criteria Character string specifying performance criterion. Choices \"V&VH\" (default), \"LinPred\", \"CIndex_pooled\", \"CIndex_foldaverage\". c_index_stratum Optional stratum vector. required criteria set \"CIndex_pooled\" \"CIndex_foldaverage\", stratified C-index desired fitted model non-stratified. Default NULL. message Logical; TRUE, prints progress messages per-fold progress bars. Default FALSE. seed Optional integer seed reproducible fold assignment. Default NULL. ... Additional arguments passed coxkl.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-Validated Selection of Integration Parameter （eta） for the Cox–KL Model — cv.coxkl","text":"object class \"cv.coxkl\" components: internal_stat data.frame one row per eta containing eta cross-validated measure named according criteria (one VVH_Loss, LinPred_Loss, CIndex_pooled, CIndex_foldaverage). external_stat Scalar baseline statistic computed RS criteria. criteria evaluation criterion used. nfolds Number folds.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-Validated Selection of Integration Parameter （eta） for the Cox–KL Model — cv.coxkl","text":"External information required: supply either RS beta (beta given, RS computed z %*% beta). Folds created stratification stratum censoring status. Within fold candidate eta, function fits coxkl training split warm-starts initialized zero evaluates test split: \"V&VH\": uses difference partial log-likelihoods full training fits; reported \\(-2\\) times aggregated quantity. \"LinPred\": aggregates test-split linear predictors across folds evaluates \\(-2\\) times partial log-likelihood full data. \"CIndex_pooled\": pools pairwise comparable counts across folds (numerator/denominator). \"CIndex_foldaverage\": averages per-fold stratified C-index. function also computes external baseline statistic RS using criterion comparison.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-Validated Selection of Integration Parameter （eta） for the Cox–KL Model — cv.coxkl","text":"","code":"data(ExampleData_lowdim)  train_dat_lowdim <- ExampleData_lowdim$train beta_external_good_lowdim <- ExampleData_lowdim$beta_external_good  etas <- generate_eta(method = \"exponential\", n = 10, max_eta = 5)  cv_res <- cv.coxkl(z = train_dat_lowdim$z,                    delta = train_dat_lowdim$status,                    time = train_dat_lowdim$time,                    beta = beta_external_good_lowdim,                    etas = etas) #> Warning: Stratum not provided. Treating all data as one stratum."},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_enet.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-Validation for CoxKL Model with elastic net & lasso penalty — cv.coxkl_enet","title":"Cross-Validation for CoxKL Model with elastic net & lasso penalty — cv.coxkl_enet","text":"function performs cross-validation high-dimensional Cox model Kullback–Leibler (KL) penalty. tunes parameter eta (external information weight) using user-specified cross-validation criteria, also evaluating lambda path (either provided generated) selecting best lambda per eta.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_enet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-Validation for CoxKL Model with elastic net & lasso penalty — cv.coxkl_enet","text":"","code":"cv.coxkl_enet(   z,   delta,   time,   stratum = NULL,   RS = NULL,   beta = NULL,   etas,   alpha = 1,   lambda = NULL,   nlambda = 100,   lambda.min.ratio = ifelse(n < p, 0.05, 0.001),   nfolds = 5,   cv.criteria = c(\"V&VH\", \"LinPred\", \"CIndex_pooled\", \"CIndex_foldaverage\"),   c_index_stratum = NULL,   message = FALSE,   seed = NULL,   ... )"},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_enet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-Validation for CoxKL Model with elastic net & lasso penalty — cv.coxkl_enet","text":"z Numeric matrix covariates rows representing individuals columns representing predictors. delta Numeric vector event indicators (1 = event, 0 = censored). time Numeric vector observed times (event censoring). stratum Optional factor numeric vector indicating strata. RS Optional numeric vector matrix external risk scores. provided, beta must supplied. beta Optional numeric vector external coefficients (length equal ncol(z)). provided, RS must supplied. etas Numeric vector candidate eta values evaluated. alpha Elastic-net mixing parameter \\((0,1]\\). Default = 1 (lasso penalty). lambda Optional numeric scalar vector penalty parameters. NULL, decreasing path generated using nlambda lambda.min.ratio. nlambda Integer number lambda values generate lambda NULL. Default 100. lambda.min.ratio Ratio smallest largest lambda generating sequence (lambda NULL). Default 0.05 n < p, otherwise 1e-3. nfolds Integer; number cross-validation folds. Default = 5. cv.criteria Character string specifying cross-validation criterion. Choices : \"V&VH\" (default): \"V&VH\" loss. \"LinPred\": loss based cross-validated linear predictors. \"CIndex_pooled\": pool held-predictions compute one overall C-index. \"CIndex_foldaverage\": average C-index across folds. c_index_stratum Optional stratum vector. Used cv.criteria \"CIndex_pooled\" \"CIndex_foldaverage\" compute stratified C-index fitted model non-stratified; supplied, must identical stratum. Default NULL. message Logical; whether print progress messages. Default = FALSE. seed Optional integer random seed fold assignment. ... Additional arguments passed coxkl_enet.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_enet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-Validation for CoxKL Model with elastic net & lasso penalty — cv.coxkl_enet","text":"object class \"cv.coxkl_enet\": integrated_stat.full_results Data frame columns eta, lambda, aggregated CV score lambda chosen cv.criteria. loss criteria, additional column transformed loss (Loss = -2 * score); C-index criteria, column named CIndex_pooled CIndex_foldaverage. integrated_stat.best_per_eta Data frame best lambda (per eta) according chosen cv.criteria (minimizing loss maximizing C-index). integrated_stat.betahat_best Matrix coefficient vectors (columns) corresponding best lambda eta. external_stat Scalar baseline statistic computed external risk score RS cv.criteria. criteria evaluation criterion used (provided cv.criteria). alpha elastic-net mixing parameter used. nfolds Number folds.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_enet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-Validation for CoxKL Model with elastic net & lasso penalty — cv.coxkl_enet","text":"Data sorted stratum time. External info must RS beta (beta given length ncol(z), RS = z %*% beta); alpha \\(\\(0,1]\\). candidate eta, decreasing lambda path used (generated nlambda/lambda.min.ratio lambda = NULL); CV folds created get_fold. fold fits coxkl_enet training split (full lambda path) evaluates chosen criterion test split. Aggregation follows code paths \"V&VH\", \"LinPred\", \"CIndex_pooled\", \"CIndex_foldaverage\": \"V&VH\": sums pl(full) - pl(train) across folds (reported loss via Loss = -2 * score). \"LinPred\": aggregates test-fold linear predictors evaluates partial log-likelihood full data (reported Loss = -2 * score). \"CIndex_pooled\": pools comparable-pair numerators/denominators across folds compute one C-index. \"CIndex_foldaverage\": averages per-fold stratified C-index. best lambda selected per eta (min loss / max C-index), function returns full results, per-eta optimum, corresponding coefficients, external baseline RS.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_enet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-Validation for CoxKL Model with elastic net & lasso penalty — cv.coxkl_enet","text":"","code":"data(ExampleData_highdim)   train_dat_highdim <- ExampleData_highdim$train beta_external_highdim <- ExampleData_highdim$beta_external  etas <- generate_eta(method = \"exponential\", n = 10, max_eta = 100)  cv_res <- cv.coxkl_enet(z = train_dat_highdim$z,                         delta = train_dat_highdim$status,                         time = train_dat_highdim$time,                         stratum = NULL,                         RS = NULL,                         beta = beta_external_highdim,                         etas = etas,                         alpha = 1.0) #> Warning: Stratum not provided. Treating all data as one stratum."},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_ridge.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-Validation for CoxKL Ridge Model (eta tuning) — cv.coxkl_ridge","title":"Cross-Validation for CoxKL Ridge Model (eta tuning) — cv.coxkl_ridge","text":"function performs cross-validation Cox model Kullback–Leibler (KL) penalty ridge (L2) regularization. tunes parameter eta (external information weight) using user-specified cross-validation criteria, internally evaluating lambda path (provided generated) selecting best lambda per eta","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_ridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-Validation for CoxKL Ridge Model (eta tuning) — cv.coxkl_ridge","text":"","code":"cv.coxkl_ridge(   z,   delta,   time,   stratum = NULL,   RS = NULL,   beta = NULL,   etas,   lambda = NULL,   nlambda = 100,   lambda.min.ratio = ifelse(n_obs < n_vars, 0.01, 1e-04),   nfolds = 5,   cv.criteria = c(\"V&VH\", \"LinPred\", \"CIndex_pooled\", \"CIndex_foldaverage\"),   c_index_stratum = NULL,   message = FALSE,   seed = NULL,   ... )"},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_ridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-Validation for CoxKL Ridge Model (eta tuning) — cv.coxkl_ridge","text":"z Numeric matrix covariates rows representing individuals columns representing predictors. delta Numeric vector event indicators (1 = event, 0 = censored). time Numeric vector observed times (event censoring). stratum Optional factor numeric vector indicating strata. RS Optional numeric vector matrix external risk scores. provided, beta must supplied. beta Optional numeric vector external coefficients (length equal ncol(z)). provided, RS must supplied. etas Numeric vector candidate eta values evaluated. lambda Optional numeric scalar vector penalty parameters. NULL, sequence generated automatically. nlambda Integer number lambda values generate lambda NULL. Default 100. lambda.min.ratio Ratio smallest largest lambda generating sequence (lambda NULL). Default 0.01 n < p, otherwise 1e-4. nfolds Integer; number cross-validation folds. Default 5. cv.criteria Character string specifying cross-validation criterion. Choices : \"V&VH\" (default): \"V&VH\" loss. \"LinPred\": loss based cross-validated linear predictors. \"CIndex_pooled\": pool held-predictions compute one overall C-index. \"CIndex_foldaverage\": average C-index across folds. c_index_stratum Optional stratum vector. Used cv.criteria \"CIndex_pooled\" \"CIndex_foldaverage\" compute stratified C-index non-stratified fit; supplied, must identical stratum. Default NULL. message Logical; whether print progress messages. Default FALSE. seed Optional integer random seed fold assignment. ... Additional arguments passed coxkl_ridge.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_ridge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-Validation for CoxKL Ridge Model (eta tuning) — cv.coxkl_ridge","text":"object class \"cv.coxkl_ridge\": integrated_stat.full_results Data frame columns eta, lambda, aggregated CV score per lambda; loss criteria additional column Loss = -2 * score; C-index criteria column named CIndex_pooled CIndex_foldaverage. integrated_stat.best_per_eta Data frame best lambda (per eta) according chosen criterion. external_stat Scalar baseline statistic computed RS cv.criteria. criteria evaluation criterion used. nfolds Number folds.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_ridge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-Validation for CoxKL Ridge Model (eta tuning) — cv.coxkl_ridge","text":"Data sorted stratum time. External information must given via RS beta (beta length ncol(z), function computes RS = z %*% beta). candidate eta, lambda path determined (generated lambda = NULL, otherwise supplied lambda values sorted decreasingly). Cross-validation folds created get_fold. fold, coxkl_ridge fit training split across full lambda path data_sorted = TRUE, chosen criterion evaluated test split aggregated: \"V&VH\": sums pl(full) - pl(train) across folds (reported loss via Loss = -2 * score). \"LinPred\": aggregates test-fold linear predictors evaluates partial log-likelihood full data (reported Loss = -2 * score). \"CIndex_pooled\": pools comparable-pair numerators/denominators across folds compute one C-index. \"CIndex_foldaverage\": averages per-fold stratified C-index. best lambda chosen per eta (minimizing loss maximizing C-index). function also computes external baseline statistic RS criterion.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.coxkl_ridge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-Validation for CoxKL Ridge Model (eta tuning) — cv.coxkl_ridge","text":"","code":"# \\donttest{ data(ExampleData_highdim)   train_dat_highdim <- ExampleData_highdim$train beta_external_highdim <- ExampleData_highdim$beta_external  etas <- generate_eta(method = \"exponential\", n = 10, max_eta = 100) cv_res <- cv.coxkl_ridge(z = train_dat_highdim$z,                          delta = train_dat_highdim$status,                          time = train_dat_highdim$time,                          beta = beta_external_highdim,                          etas = etas) #> Warning: Stratum not provided. Treating all data as one stratum. # }"},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Cross-Validation Results vs Eta — cv.plot","title":"Plot Cross-Validation Results vs Eta — cv.plot","text":"Plots cross-validated performance across eta cv.coxkl, cv.coxkl_ridge, cv.coxkl_enet results. main CV curve drawn solid purple line; green dotted horizontal reference line placed value corresponding eta = 0 (closest available eta), solid green point marking reference level.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Cross-Validation Results vs Eta — cv.plot","text":"","code":"cv.plot(object, line_color = \"#7570B3\", baseline_color = \"#1B9E77\", ...)"},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Cross-Validation Results vs Eta — cv.plot","text":"object fitted cross-validation result class \"cv.coxkl\", \"cv.coxkl_ridge\", \"cv.coxkl_enet\". line_color Color CV performance curve. Default \"#7570B3\". baseline_color Color horizontal reference line point. Default \"#1B9E77\". ... Additional arguments (currently ignored).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Cross-Validation Results vs Eta — cv.plot","text":"ggplot object showing cross-validation performance versus eta.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Cross-Validation Results vs Eta — cv.plot","text":"function reads performance metric object: \"cv.coxkl\": uses object$internal_stat (one row per eta). \"cv.coxkl_ridge\" \"cv.coxkl_enet\": uses object$integrated_stat.best_per_eta (best lambda per eta). y-axis label set “Loss” criteria object “V&VH” “LinPred”; otherwise “C Index”. horizontal reference (“baseline”) taken plotted series eta = 0 (nearest eta present results).","code":""},{"path":[]},{"path":"https://um-kevinhe.github.io/survkl/reference/cv.plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Cross-Validation Results vs Eta — cv.plot","text":"","code":"data(Exampledata_lowdim) #> Warning: data set 'Exampledata_lowdim' not found  train_dat_lowdim <- ExampleData_lowdim$train beta_external_good_lowdim <- ExampleData_lowdim$beta_external_good  etas <- generate_eta(method = \"exponential\", n = 100, max_eta = 30) cv_res <- cv.coxkl(z = train_dat_lowdim$z,                    delta = train_dat_lowdim$status,                    time = train_dat_lowdim$time,                    stratrum = train_dat_lowdim$stratum,                    beta = beta_external_good_lowdim,                    etas = etas,                    nfolds = 5,                    criteria = c(\"V&VH\"),                    seed = 1) #> Warning: Stratum not provided. Treating all data as one stratum. cv.plot(cv_res)"},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_highdim.html","id":null,"dir":"Reference","previous_headings":"","what":"Example high-dimensional survival data — ExampleData_highdim","title":"Example high-dimensional survival data — ExampleData_highdim","text":"simulated survival dataset high-dimensional linear setting 50 covariates (6 signals + 44 AR(1) noise), Weibull baseline hazard, controlled censoring. Includes internal train/test sets, external-data–estimated coefficient vector.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_highdim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example high-dimensional survival data — ExampleData_highdim","text":"","code":"data(ExampleData_highdim)"},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_highdim.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example high-dimensional survival data — ExampleData_highdim","text":"list containing following elements: train list components: z Data frame size \\(n_\\mathrm{train}\\times 50\\) covariates Z1–Z50. status Vector event indicators (1=event, 0=censored). time Numeric vector observed times \\(\\min(T, C)\\). stratum Vector stratum labels (1). test list structure train, size \\(n_\\mathrm{test}\\times 50\\) z. beta_external Numeric vector (length 50, named Z1–Z50) Cox coefficients estimated external dataset using Z1–Z6 expanded length 50 (zeros Z7–Z50).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_highdim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Example high-dimensional survival data — ExampleData_highdim","text":"Data-generating mechanism: Covariates: 50 variables signals Z1–Z6 noise Z7–Z50. Z1, Z2 ~ bivariate normal AR(1) correlation \\(\\rho=0.5\\). Z3, Z4 ~ independent Bernoulli(0.5). Z5 ~ \\(N(2,1)\\), Z6 ~ \\(N(-2,1)\\) (group indicator fixed 1). Z7–Z50 ~ multivariate normal AR(1) correlation \\(\\rho=0.5\\). True coefficients: \\(\\beta = (0.3,-0.3,0.3,-0.3,0.3,-0.3,0,\\ldots,0)\\) (length 50). Event times: Weibull baseline hazard \\(h_0(t)=\\lambda\\nu\\, t^{\\nu-1}\\) \\(\\lambda=1\\), \\(\\nu=2\\). Given linear predictor \\(\\eta = Z^\\top \\beta\\), draw \\(U\\sim\\mathrm{Unif}(0,1)\\) set $$T = \\left(\\frac{-\\log U}{\\lambda\\, e^{\\eta}}\\right)^{1/\\nu}.$$ Censoring: \\(C\\sim \\mathrm{Unif}(0,\\text{ub})\\) ub tuned iteratively achieve target censoring rate (internal: 0.70; external: 0.50). Observed time \\(\\min(T,C)\\), status \\(\\mathbf{1}\\{T \\le C\\}\\). External coefficients: Fit Cox model Surv(time, status) ~ Z1 + ... + Z6 external data (Breslow ties), place estimated coefficients length-50 vector (zeros elsewhere).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_highdim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Example high-dimensional survival data — ExampleData_highdim","text":"","code":"data(ExampleData_highdim)  head(ExampleData_highdim$train$z) #>           Z1         Z2 Z3 Z4       Z5        Z6          Z7         Z8 #> 1  0.8341847  1.2548397  0  1 1.230205 -1.379354  0.29715594 -0.1846824 #> 2 -0.3289623 -0.5440874  1  1 3.009319 -2.027648  0.06107997 -0.7877205 #> 3 -3.1720374 -0.4180468  1  0 2.387088 -2.780979 -0.85233051 -1.3215052 #> 4  0.1281318 -0.8776107  1  1 2.521981 -2.184659 -0.71413081  0.9238884 #> 5 -1.2284273 -0.7566494  0  1 1.762825 -2.555997 -1.87046640 -1.2583798 #> 6  0.8213465  1.4635825  1  1 1.887867 -1.232408  0.02923435 -0.5281927 #>           Z9        Z10        Z11        Z12        Z13        Z14        Z15 #> 1  1.0982052  0.4904068  0.5025818  0.9381855  0.4799360  0.3437346  0.4320523 #> 2 -1.2572372 -0.7316574 -1.2545473  0.3399338 -2.3401946 -0.6721147 -0.7741806 #> 3 -0.8917207  0.5492385  1.2280196 -0.4813451  0.4396726  0.5759964 -0.3324509 #> 4  0.2700611 -0.5746064 -0.3090879  0.2892202  1.2383940  1.4950458 -0.2552768 #> 5 -0.8879612 -1.1652591 -1.3263840  0.1811636  1.0627427  0.7584533  0.8554499 #> 6 -1.3821379  0.7588488  1.1300513 -0.3151114  0.2124996 -0.7406890 -0.6363002 #>          Z16        Z17        Z18         Z19         Z20        Z21 #> 1  0.8633326  0.7533490  1.0215138  1.51246470  0.94004928 -0.2257148 #> 2 -0.0393791 -0.5752974 -0.8462299 -0.16716546 -1.79317838 -0.5395597 #> 3 -1.3388491  0.1427682 -0.2026194  1.60425188  2.47017074  0.4935123 #> 4 -0.5982543  0.1761313 -0.9428526 -0.98955493  1.55572861  1.5238076 #> 5 -0.6517327 -1.5715401 -0.8141908 -0.03304642 -0.01628385 -1.3252785 #> 6 -1.2840411  0.1747675 -0.1237938  0.29138370  0.14430507  0.6488622 #>          Z22        Z23        Z24         Z25        Z26        Z27        Z28 #> 1  1.2631874 -0.8176610 -1.3054956 -2.59423303 -1.0819914 -1.7759045 -0.3130515 #> 2  0.2219920 -1.3828436  0.2169797  0.69637444  0.1963209  0.3101008  0.1045186 #> 3 -0.5419710 -0.5775182 -0.9108406  0.18592158  1.3871736  0.2519995  0.9655862 #> 4  0.7762024 -0.3625580 -1.6130505 -1.06893004  0.3174351  1.0103921 -0.4376606 #> 5 -0.6695136 -0.5061301  0.0331691 -0.73308691  0.2968483  0.3420247  0.3465201 #> 6  1.7856642 -0.8147424 -1.9587034 -0.05948988 -1.1346326  0.2344805 -0.5347376 #>          Z29        Z30        Z31        Z32         Z33         Z34 #> 1  0.1450573 -0.3522625  1.3583706 -1.1354976 -0.08176453  0.90301566 #> 2  0.1736015  0.1832902 -1.0431791 -1.6964999 -1.59347993 -2.33205882 #> 3 -0.3261791 -0.2129586 -1.1342233 -0.4226060  0.96752663 -0.11062591 #> 4 -1.0527535 -0.6244569 -0.3397628  1.1462418  0.45662572  0.05212241 #> 5 -0.7050586 -0.8054282 -0.8825711 -1.4828052  0.14471226  0.12423004 #> 6  0.1302796  0.4279924  0.5541080  0.5823341 -0.53471012 -0.37043642 #>           Z35         Z36        Z37        Z38        Z39        Z40 #> 1 -0.33873339  0.90547061  0.9280060 -0.1313232 -0.5279536  0.7480440 #> 2 -2.03014417 -1.01837762 -0.9425266 -0.7156324 -1.2498089  0.2309582 #> 3 -0.04469714 -0.05222202 -0.8417919 -0.5504270  0.6418680  1.4240399 #> 4 -0.21573577 -0.91514694  0.1936167  0.4127731  0.1198166  0.2578691 #> 5  1.04310306  1.31328693  0.1785853 -2.0694800 -2.3911914 -1.2461304 #> 6  0.79710530  0.36294685  0.8356093  0.3896813 -0.9716663 -0.4682918 #>            Z41         Z42          Z43        Z44         Z45         Z46 #> 1  0.626297434  0.04292509  0.612210812 -1.2068899 -1.03689495 -0.63210927 #> 2  1.043110114  0.51952039 -0.709333558  1.5400533  1.40551197  2.54570573 #> 3  0.009322651  1.00946381  0.201396249  0.7608163  0.60980799  0.07967597 #> 4  0.375786446 -0.07833188  0.004788632  1.4215175  1.26539924 -1.54623996 #> 5 -0.205232458  1.02566517  1.481439960  2.0989416  0.04201603 -0.39717619 #> 6 -0.662404892  0.11826542 -0.038936256 -1.8301693 -1.24983745 -0.61987848 #>           Z47       Z48        Z49        Z50 #> 1 -0.75296206 -1.466023 -0.6107553  0.5837428 #> 2  1.88849816  2.157199  0.6465888 -0.3936396 #> 3  0.25028165 -1.490555 -0.6696376  0.6741264 #> 4  1.26147753 -0.467992  1.0971287  1.3047671 #> 5  0.01994461 -0.493669 -0.3828498  0.5840523 #> 6  0.28317437  1.268658  1.8107407  0.1405356 table(ExampleData_highdim$train$status) #>  #>   0   1  #> 144  56  summary(ExampleData_highdim$train$time) #>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  #> 0.002357 0.118257 0.226289 0.229358 0.339145 0.575841   head(ExampleData_highdim$test$z) #>           Z1          Z2 Z3 Z4        Z5        Z6         Z7          Z8 #> 1 -0.8755157 -0.19970306  1  0 2.4542939 -3.280559 0.13764707 -0.29951270 #> 2  0.8236265  0.07930611  1  0 1.4890025 -3.938458 0.22951537 -0.27756548 #> 3  0.9263612 -0.01997836  1  1 0.6358499 -3.195342 0.52670452  0.05328195 #> 4  0.1850598 -0.70337717  0  1 2.2810817 -4.434547 0.79721336 -0.31697608 #> 5  0.3474487 -0.42614590  0  0 0.7145202 -2.830799 0.07278411 -1.42828452 #> 6 -0.8803044 -0.91163905  0  0 2.4224220 -2.329654 1.28874933 -0.30053293 #>           Z9        Z10         Z11        Z12        Z13        Z14        Z15 #> 1 -1.8593895 -0.1736244 -0.03612483  1.7472408  1.7360144  1.6572400  0.7806403 #> 2  0.2713486  0.2236954 -1.35911106 -0.3897491 -0.3989989  0.1117077 -0.2587745 #> 3  0.2293453 -0.5221144 -0.41978900 -0.6275746 -1.0680740  0.5019976  0.9790618 #> 4 -1.0048234 -1.1459370  0.26200422  0.4194908  2.3126135  0.6683572  0.6028322 #> 5 -0.4451788  0.4631919  1.05744097  1.3881108  1.2026630 -1.8938359 -1.0292716 #> 6 -0.7162089  1.0104155 -0.38368599  0.4486694 -0.6833364 -1.1513100 -0.1524856 #>          Z16        Z17         Z18         Z19         Z20        Z21 #> 1  1.0419634  1.0014758  0.87853402  1.20154893  0.70993166  0.6926842 #> 2  2.5036764  1.0563505  0.49304476  0.83883757  0.53522160  1.7725695 #> 3  1.9456876  0.2410226  0.93140905 -0.50013494 -0.24039917 -1.3943652 #> 4  0.6518553  0.5833234  0.56267706 -0.68226000 -0.49821852  0.4635016 #> 5 -1.1394870 -0.6498890 -0.63055354 -0.67106393 -1.36795205  0.7937763 #> 6 -2.1706700 -0.6895768 -0.09568807  0.01370934  0.07330939  1.4275766 #>          Z22         Z23         Z24         Z25         Z26        Z27 #> 1  0.1522400  0.72886816  0.96106634  0.75738274 -0.24679473  0.3333615 #> 2  0.1914927 -0.24217057 -1.69998202 -0.83921306 -0.83895440  0.2525735 #> 3  0.2215496 -3.38045379 -1.67431365 -0.08341914 -1.07549132 -0.9306513 #> 4  0.8072025 -0.06383284  1.40726238  0.61687798  0.42779651  0.3411079 #> 5 -0.8177690 -0.07890665  1.10520120  0.75595253  2.58006781  1.6626002 #> 6  1.1219039  2.08552715 -0.01395411 -0.58492795  0.05189429  0.3238361 #>          Z28        Z29          Z30         Z31          Z32         Z33 #> 1  1.8533162  1.1413543  0.006618972 -0.31956804  0.221347062  0.01912242 #> 2 -0.3164956 -1.3575425  0.098572849  0.53449844 -0.008900405 -1.03863804 #> 3 -1.4797537 -0.3794754 -0.995543024 -1.07427224  0.071562637 -1.64276895 #> 4 -0.1274482 -0.4986956 -1.922319725 -0.84184222 -0.806627329  0.19492516 #> 5  1.3229320  0.9924067 -0.181815965  0.04308887  1.322061805  0.33903185 #> 6 -0.9531971 -0.7657889  0.221706398 -0.39189299 -0.107754578  0.14435895 #>           Z34         Z35         Z36         Z37         Z38        Z39 #> 1  0.02259753 -0.03638311  1.31072107  0.63267465  0.70821261 -0.9644446 #> 2 -0.83534512 -1.02532257  1.42087476  1.59472721  0.99560368  0.8583339 #> 3 -1.88285945 -1.23116307 -0.74063599 -0.07947944  0.84127101  0.6270051 #> 4 -0.57991673 -0.05609040 -0.03119781 -0.18212746 -0.03795407  1.4248389 #> 5  0.96870265  0.25522277  0.44204637  0.61391922  1.20862465  0.8528802 #> 6 -0.27541315  1.29134035  2.20868594  1.90517098  2.78024828  1.5704774 #>           Z40          Z41        Z42         Z43        Z44        Z45 #> 1  0.22510720  0.007031161  0.7480677 -0.33153709 -0.1101352 -0.4382325 #> 2 -0.18666426 -0.453598905  0.3280036 -0.07132729 -0.2260509 -1.3126325 #> 3  0.41890927 -0.893598361 -2.9933830 -0.48448676 -0.1082089 -0.6425374 #> 4  2.43427290 -0.059044636 -0.2373969  1.03315480  0.6519150  0.4775821 #> 5  0.07008611 -0.466548212 -1.4381315 -1.17389378 -0.8892987 -1.9979700 #> 6  1.82803873  0.190203105  0.5919327 -0.88877615 -0.4811745  0.6985946 #>           Z46        Z47        Z48          Z49        Z50 #> 1 -0.80117966  0.3576286 -1.0226513  0.301427228  1.5643462 #> 2 -0.06452281  0.2829715  1.0356304  0.984220152 -0.4857993 #> 3 -1.16150511 -0.4833850 -0.3193366 -0.001306896  0.0298568 #> 4 -0.41523841 -0.1098118  1.3527896  1.375761270  2.1009230 #> 5 -0.71063502  1.2419492  1.5455219 -0.117504888 -0.3591661 #> 6  0.82786996 -0.3889966 -1.9303816 -1.512722570 -1.8478961 table(ExampleData_highdim$test$status) #>  #>    0    1  #> 1376  624  summary(ExampleData_highdim$test$time) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> 0.0003132 0.1309088 0.2467850 0.2605349 0.3766332 0.6122603"},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_lowdim.html","id":null,"dir":"Reference","previous_headings":"","what":"Example low-dimensional survival data — ExampleData_lowdim","title":"Example low-dimensional survival data — ExampleData_lowdim","text":"simulated survival dataset low-dimensional linear setting 6 covariates (2 correlated continuous, 2 binary, 2 mean-shifted normals), Weibull baseline hazard, controlled censoring. Includes internal train/test sets, three external-quality coefficient vectors.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_lowdim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example low-dimensional survival data — ExampleData_lowdim","text":"","code":"data(ExampleData_lowdim)"},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_lowdim.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example low-dimensional survival data — ExampleData_lowdim","text":"list containing following elements: train list components: z Data frame size \\(n_\\mathrm{train}\\times 6\\) covariates Z1–Z6. status Vector event indicators (1=event, 0=censored). time Numeric vector observed times \\(\\min(T, C)\\). stratum Vector stratum labels (1). test list structure train, size \\(n_\\mathrm{test}\\times 6\\) z. beta_external_good Numeric vector (length 6; named Z1–Z6) Cox coefficients estimated \"Good\" external dataset using Z1–Z6. beta_external_fair Numeric vector (length 6; names Z1–Z6) Cox coefficients estimated \"Fair\" external dataset using reduced subset Z1, Z3, Z5, Z6; coefficients variables used 0. beta_external_poor Numeric vector (length 6; names Z1–Z6) Cox coefficients estimated \"Poor\" external dataset using Z1 Z5 ; remaining entries 0.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_lowdim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Example low-dimensional survival data — ExampleData_lowdim","text":"Data-generating mechanism: Covariates: 6 variables Z1–Z6. Z1, Z2 ~ bivariate normal AR(1) correlation \\(\\rho=0.5\\). Z3, Z4 ~ independent Bernoulli(0.5). Z5 ~ \\(N(2,1)\\), Z6 ~ \\(N(-2,1)\\) (group indicator fixed 1 internal train/test). True coefficients: \\(\\beta = (0.3,-0.3,0.3,-0.3,0.3,-0.3)\\) (length 6). Event times: Weibull baseline hazard \\(h_0(t)=\\lambda\\nu \\, t^{\\nu-1}\\) \\(\\lambda=1\\), \\(\\nu=2\\). Given linear predictor \\(\\eta = Z^\\top \\beta\\), draw \\(U\\sim\\mathrm{Unif}(0,1)\\) set $$T = \\left(\\frac{-\\log U}{\\lambda \\, e^{\\eta}}\\right)^{1/\\nu}.$$ Censoring: \\(C\\sim \\mathrm{Unif}(0,\\text{ub})\\) ub tuned iteratively achieve target censoring rate (internal: 0.70; external: 0.50). Observed time \\(\\min(T,C)\\), status \\(\\mathbf{1}\\{T \\le C\\}\\). External coefficients: quality level (\"Good\", \"Fair\", \"Poor\"), fit Cox model Surv(time, status) ~ Z1 + ... corresponding external data (Breslow ties) using specified covariate subset; place estimates length-6 vector named Z1–Z6 zeros variables included.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/ExampleData_lowdim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Example low-dimensional survival data — ExampleData_lowdim","text":"","code":"data(ExampleData_lowdim)  head(ExampleData_lowdim$train$z) #>           Z1          Z2 Z3 Z4       Z5         Z6 #> 1 -3.3155831 -1.89064873  1  0 2.317864 -1.5746080 #> 2 -1.2930025  1.22289522  0  0 4.586152 -2.6807152 #> 3 -1.1529450 -0.15452519  0  1 2.887956 -2.3298936 #> 4 -0.3027544 -0.70427194  1  1 1.946349 -1.4054008 #> 5 -0.2513522  0.06933996  1  1 1.665034 -2.9357721 #> 6  2.6636660  1.27748351  0  0 1.450750 -0.6265481 table(ExampleData_lowdim$train$status) #>  #>  0  1  #> 71 29  summary(ExampleData_lowdim$train$time) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> 7.290e-06 1.125e-01 2.219e-01 2.439e-01 3.477e-01 6.160e-01   head(ExampleData_lowdim$test$z) #>           Z1         Z2 Z3 Z4       Z5         Z6 #> 1 -0.4360609 -0.2970776  1  0 1.470499 -2.1341620 #> 2 -0.8269507 -0.2030743  1  0 1.144320 -0.8558692 #> 3  0.0168703 -0.7136223  0  0 2.754666 -3.2948610 #> 4  1.2085367 -1.0212701  0  0 1.634704 -2.4248350 #> 5  1.1490034  0.4739340  1  1 1.360401 -1.7800655 #> 6  0.2142821  1.1105678  1  0 2.039943 -2.4492855 table(ExampleData_lowdim$test$status) #>  #>    0    1  #> 1410  590  summary(ExampleData_lowdim$test$time) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> 3.316e-05 1.208e-01 2.265e-01 2.428e-01 3.625e-01 5.908e-01"},{"path":"https://um-kevinhe.github.io/survkl/reference/generate_eta.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a Sequence of Tuning Parameters (eta) — generate_eta","title":"Generate a Sequence of Tuning Parameters (eta) — generate_eta","text":"Produces numeric vector eta values used Cox–KL model.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/generate_eta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a Sequence of Tuning Parameters (eta) — generate_eta","text":"","code":"generate_eta(method = \"exponential\", n = 10, max_eta = 5, min_eta = 0)"},{"path":"https://um-kevinhe.github.io/survkl/reference/generate_eta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a Sequence of Tuning Parameters (eta) — generate_eta","text":"method Character string selecting generate eta: “linear” “exponential”. Default “exponential”. exponentially spaced sequence scaled max_eta. Default \"exponential\". n Integer, number eta values generate. Default 10. max_eta Numeric, maximum value eta sequence. Default 5. min_eta Numeric, minimum value eta sequence. Default 0.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/generate_eta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a Sequence of Tuning Parameters (eta) — generate_eta","text":"Numeric vector length n containing generated eta values.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/generate_eta.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a Sequence of Tuning Parameters (eta) — generate_eta","text":"Exponential: values formed exponentiating grid log(1) log(100), linearly rescaling interval [0, max_eta]. Thus smallest value equals 0 largest equals max_eta. Linear: current implementation calls seq(min_eta, max_eta, length.= n) therefore assumes numeric object min_eta exists calling environment. exact strings “linear” “exponential” supported; values method result error eta_values never created.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/generate_eta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a Sequence of Tuning Parameters (eta) — generate_eta","text":"","code":"# Generate 10 exponentially spaced eta values up to 5 generate_eta(method = \"exponential\", n = 10, max_eta = 5) #>  [1] 0.00000000 0.03374245 0.09002825 0.18391863 0.34053721 0.60179276 #>  [7] 1.03759328 1.76455236 2.97719318 5.00000000  # Generate 5 linearly spaced eta values up to 3 generate_eta(method = \"linear\", n = 5, max_eta = 3) #> [1] 0.00 0.75 1.50 2.25 3.00"},{"path":"https://um-kevinhe.github.io/survkl/reference/loss_fn.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the Log-Partial Likelihood for a Stratified Cox Model — loss_fn","title":"Calculate the Log-Partial Likelihood for a Stratified Cox Model — loss_fn","text":"Computes stratified Cox partial log-likelihood given covariates, event indicators, times, coefficients.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/loss_fn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the Log-Partial Likelihood for a Stratified Cox Model — loss_fn","text":"","code":"loss_fn(z, delta, time, stratum, beta)"},{"path":"https://um-kevinhe.github.io/survkl/reference/loss_fn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the Log-Partial Likelihood for a Stratified Cox Model — loss_fn","text":"z numeric matrix (data frame coercible matrix) covariates. row observation column predictor. delta numeric vector event indicators (1 = event, 0 = censored). time numeric vector observed times (event censoring). stratum optional vector specifying stratum observation (factor/character/numeric). missing, single-stratum model assumed. beta numeric vector regression coefficients length equal number columns z.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/loss_fn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the Log-Partial Likelihood for a Stratified Cox Model — loss_fn","text":"single numeric value giving stratified Cox partial log-likelihood.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/loss_fn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate the Log-Partial Likelihood for a Stratified Cox Model — loss_fn","text":"Inputs internally sorted stratum time. function evaluates stratified Cox partial log-likelihood using supplied z, delta, beta, stratum sizes.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Performance vs Eta for coxkl — plot.coxkl","title":"Plot Model Performance vs Eta for coxkl — plot.coxkl","text":"Plots model performance across eta sequence. Performance either loss (-2 times partial log-likelihood) concordance index (C-index). test data provided, curve computed training data stored object$data.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Performance vs Eta for coxkl — plot.coxkl","text":"","code":"# S3 method for class 'coxkl' plot(   object,   test_z = NULL,   test_time = NULL,   test_delta = NULL,   test_stratum = NULL,   criteria = c(\"loss\", \"CIndex\"),   ... )"},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Performance vs Eta for coxkl — plot.coxkl","text":"object fitted model object class \"coxkl\". test_z Optional numeric matrix test covariates. test_time Optional numeric vector test survival times. test_delta Optional numeric vector test event indicators. test_stratum Optional vector test stratum membership. criteria Character string: \"loss\" \"CIndex\". ... Additional arguments (ignored).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Performance vs Eta for coxkl — plot.coxkl","text":"ggplot object showing performance curve.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Model Performance vs Eta for coxkl — plot.coxkl","text":"criteria = \"loss\" test data supplied, plotted values (-2 * object$likelihood) / n, n number rows (training) data. test data provided, performance computed via test_eval(..., criteria = \"loss\") divided test sample size. criteria = \"CIndex\", performance computed via test_eval(..., criteria = \"CIndex\") chosen dataset. plot adds dotted horizontal reference line value corresponding eta = 0 (closest point eta grid).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Performance vs Eta for coxkl — plot.coxkl","text":"","code":"data(ExampleData_lowdim)  train_dat_lowdim  <- ExampleData_lowdim$train test_dat_lowdim   <- ExampleData_lowdim$test beta_external_good_lowdim <- ExampleData_lowdim$beta_external_good eta_grid <- generate_eta(method = \"exponential\", n = 100, max_eta = 30)  model <- coxkl(z = train_dat_lowdim$z,                delta = train_dat_lowdim$status,                time = train_dat_lowdim$time,                stratum = train_dat_lowdim$stratum,                beta = beta_external_good_lowdim,                etas = eta_grid) plot(model,      test_z = test_dat_lowdim$z,       test_time = test_dat_lowdim$time,       test_delta = test_dat_lowdim$status,       test_stratum = test_dat_lowdim$stratum,       criteria = \"loss\") #> Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #> ℹ Please use `linewidth` instead. #> ℹ The deprecated feature was likely used in the survkl package. #>   Please report the issue to the authors."},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_enet.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Performance vs Lambda for coxkl_enet — plot.coxkl_enet","title":"Plot Model Performance vs Lambda for coxkl_enet — plot.coxkl_enet","text":"Plots model performance across lambda sequence. Performance loss (-2 times partial log-likelihood) concordance index (C-index). test data provided, curve uses training data stored object$data.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_enet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Performance vs Lambda for coxkl_enet — plot.coxkl_enet","text":"","code":"# S3 method for class 'coxkl_enet' plot(   object,   test_z = NULL,   test_time = NULL,   test_delta = NULL,   test_stratum = NULL,   criteria = c(\"loss\", \"CIndex\"),   ... )"},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_enet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Performance vs Lambda for coxkl_enet — plot.coxkl_enet","text":"object fitted model object class \"coxkl_enet\". test_z Optional numeric matrix test covariates. test_time Optional numeric vector test survival times. test_delta Optional numeric vector test event indicators. test_stratum Optional vector test stratum membership. criteria Character string: \"loss\" \"CIndex\". ... Additional arguments (ignored).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_enet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Performance vs Lambda for coxkl_enet — plot.coxkl_enet","text":"ggplot object showing performance curve.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_enet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Model Performance vs Lambda for coxkl_enet — plot.coxkl_enet","text":"criteria = \"loss\" test data supplied, plotted values -2 * object$likelihood (normalization). test data provided, performance computed via test_eval(..., criteria). x-axis shown decreasing lambda reversed log10 scale.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_enet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Performance vs Lambda for coxkl_enet — plot.coxkl_enet","text":"","code":"data(ExampleData_highdim)   train_dat_highdim <- ExampleData_highdim$train test_dat_highdim <- ExampleData_highdim$test beta_external_highdim <- ExampleData_highdim$beta_external  model_enet <- coxkl_enet(z = train_dat_highdim$z,                          delta = train_dat_highdim$status,                          time = train_dat_highdim$time,                          beta = beta_external_highdim,                          eta = 1,                          alpha = 1.0) plot(model_enet,      test_z = test_dat_highdim$z,      test_time = test_dat_highdim$time,      test_delta = test_dat_highdim$status,      test_stratum = test_dat_highdim$stratum,      criteria = \"loss\")"},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_ridge.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Performance vs Lambda for coxkl_ridge — plot.coxkl_ridge","title":"Plot Model Performance vs Lambda for coxkl_ridge — plot.coxkl_ridge","text":"Plots model performance across lambda sequence. Performance loss (-2 times partial log-likelihood) concordance index (C-index). test data provided, curve uses training data stored object$data.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_ridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Performance vs Lambda for coxkl_ridge — plot.coxkl_ridge","text":"","code":"# S3 method for class 'coxkl_ridge' plot(   object,   test_z = NULL,   test_time = NULL,   test_delta = NULL,   test_stratum = NULL,   criteria = c(\"loss\", \"CIndex\"),   ... )"},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_ridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Performance vs Lambda for coxkl_ridge — plot.coxkl_ridge","text":"object fitted model object class \"coxkl_ridge\". test_z Optional numeric matrix test covariates. test_time Optional numeric vector test survival times. test_delta Optional numeric vector test event indicators. test_stratum Optional vector test stratum membership. criteria Character string: \"loss\" \"CIndex\". ... Additional arguments (ignored).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_ridge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Performance vs Lambda for coxkl_ridge — plot.coxkl_ridge","text":"ggplot object showing performance curve.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_ridge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Model Performance vs Lambda for coxkl_ridge — plot.coxkl_ridge","text":"criteria = \"loss\" test data supplied, plotted values -2 * object$likelihood (normalization). test data provided, performance computed via test_eval(..., criteria). x-axis shown decreasing lambda reversed log10 scale.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/plot.coxkl_ridge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Model Performance vs Lambda for coxkl_ridge — plot.coxkl_ridge","text":"","code":"data(ExampleData_highdim)   train_dat_highdim <- ExampleData_highdim$train test_dat_highdim <- ExampleData_highdim$test beta_external_highdim <- ExampleData_highdim$beta_external   model_ridge <- coxkl_ridge(z = train_dat_highdim$z,                            delta = train_dat_highdim$status,                            time = train_dat_highdim$time,                            beta = beta_external_highdim,                            eta = 1) #> Warning: Stratum information not provided. All data is assumed to originate from a single stratum!  plot(   model_ridge,   test_z       = test_dat_highdim$z,   test_time    = test_dat_highdim$time,   test_delta   = test_dat_highdim$status,   test_stratum = test_dat_highdim$stratum,   criteria     = \"CIndex\" )"},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict Linear Predictors from a coxkl Object — predict.coxkl","title":"Predict Linear Predictors from a coxkl Object — predict.coxkl","text":"Computes linear predictors new data based fitted coxkl model. eta supplied, predictions returned eta values; otherwise predictions returned fitted etas. Linear interpolation applied intermediate eta value requested.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict Linear Predictors from a coxkl Object — predict.coxkl","text":"","code":"# S3 method for class 'coxkl' predict(object, newz, eta = NULL, ...)"},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict Linear Predictors from a coxkl Object — predict.coxkl","text":"object fitted model object class \"coxkl\". newz numeric matrix data frame new covariates (must match dimension training design matrix used fit model). eta Optional numeric vector eta value(s) predict. NULL, predictions fitted eta values returned. ... Additional arguments.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict Linear Predictors from a coxkl Object — predict.coxkl","text":"numeric matrix linear predictors one column per eta (sorted ascending).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict Linear Predictors from a coxkl Object — predict.coxkl","text":"linear predictors computed .matrix(newz) %*% beta.","code":""},{"path":[]},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_enet.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict Linear Predictors from a coxkl_enet Object — predict.coxkl_enet","title":"Predict Linear Predictors from a coxkl_enet Object — predict.coxkl_enet","text":"Computes linear predictors new data using fitted coxkl_enet model. lambda supplied, predictions returned lambda values; otherwise predictions returned fitted lambdas. requested lambda lies fitted values, coefficients linearly interpolated.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_enet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict Linear Predictors from a coxkl_enet Object — predict.coxkl_enet","text":"","code":"# S3 method for class 'coxkl_enet' predict(object, newz, lambda = NULL, ...)"},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_enet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict Linear Predictors from a coxkl_enet Object — predict.coxkl_enet","text":"object fitted model object class \"coxkl_enet\". newz numeric matrix data frame new covariates (columns training data). lambda Optional numeric value(s) specifying regularization parameter(s) predict. NULL, predictions fitted lambda values returned. ... Additional arguments.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_enet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict Linear Predictors from a coxkl_enet Object — predict.coxkl_enet","text":"numeric matrix linear predictors. column corresponds one lambda, sorted descending order.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_enet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict Linear Predictors from a coxkl_enet Object — predict.coxkl_enet","text":"linear predictors computed .matrix(newz) %*% beta.","code":""},{"path":[]},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_ridge.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict Linear Predictors from a coxkl_ridge Object — predict.coxkl_ridge","title":"Predict Linear Predictors from a coxkl_ridge Object — predict.coxkl_ridge","text":"Computes linear predictors new data using fitted coxkl_ridge model. lambda supplied, predictions returned lambda values; otherwise predictions returned fitted lambdas. requested lambda lies fitted values, coefficients linearly interpolated.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_ridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict Linear Predictors from a coxkl_ridge Object — predict.coxkl_ridge","text":"","code":"# S3 method for class 'coxkl_ridge' predict(object, newz, lambda = NULL, ...)"},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_ridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict Linear Predictors from a coxkl_ridge Object — predict.coxkl_ridge","text":"object fitted model object class \"coxkl_ridge\". newz numeric matrix data frame new covariates (columns training data). lambda Optional numeric value(s) specifying regularization parameter(s) predict. NULL, predictions fitted lambda values returned. ... Additional arguments.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_ridge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict Linear Predictors from a coxkl_ridge Object — predict.coxkl_ridge","text":"numeric matrix linear predictors. column corresponds one lambda, sorted descending order.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/predict.coxkl_ridge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict Linear Predictors from a coxkl_ridge Object — predict.coxkl_ridge","text":"linear predictors computed .matrix(newz) %*% beta.","code":""},{"path":[]},{"path":"https://um-kevinhe.github.io/survkl/reference/support.html","id":null,"dir":"Reference","previous_headings":"","what":"Study to Understand Prognoses Preferences Outcomes and Risks of Treatment — support","title":"Study to Understand Prognoses Preferences Outcomes and Risks of Treatment — support","text":"support dataset tracks five response variables: hospital death, severe functional disability, hospital costs, time death death . patients followed 5.56 years. See Bhatnagar et al. (2020) details.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/support.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Study to Understand Prognoses Preferences Outcomes and Risks of Treatment — support","text":"","code":"data(support)"},{"path":"https://um-kevinhe.github.io/survkl/reference/support.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Study to Understand Prognoses Preferences Outcomes and Risks of Treatment — support","text":"data frame 9,104 observations 34 variables imputation removal response variables like hospital charges, patient ratio costs charges micro-costs following Bhatnagar et al. (2020). Ordinal variables, namely functional disability income, also removed. Finally, Surrogate activities daily living removed due sparsity. 6 model scores data-set removed; aps sps kept. age stores double representing age. death death time NDI (National Death Index) date: 12/31/1994. sex 0=female, 1=male. slos days study entry discharge. d.time days follow-. dzgroup level dzgroup: ARF/MOSF w/Sepsis, COPD, CHF, Cirrhosis, Coma, Colon Cancer, Lung Cancer, MOSF malignancy. dzclass ARF/MOSF, COPD/CHF/Cirrhosis, Coma cancer disease classes. num.co number comorbidities. edu years education patients. scoma SUPPORT coma score based Glasgow D3. avtisst average TISS, days 3-25. race indicates race: White, Black, Asian, Hispanic . hday day Hospital Study Admit. diabetes diabetes (Com27-28, Dx 73). dementia dementia (Comorbidity 6). ca cancer state. meanbp mean arterial blood pressure day 3. wblc white blood cell count day 3. hrt heart rate day 3. resp respiration rate day 3. temp temperature, Celsius, day 3. pafi PaO2/(0.01*FiO2) day 3. alb serum albumin day 3. bili bilirubin day 3. crea serum creatinine day 3. sod serum sodium day 3. ph serum pH (arteries) day 3. glucose serum glucose day 3. bun bun day 3. urine urine output day 3. adlp adl patient day 3. adlsc imputed adl calibrated surrogate, surrogate used follow . sps SUPPORT physiology score. aps apache III physiology score.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/support.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Study to Understand Prognoses Preferences Outcomes and Risks of Treatment — support","text":"Available following website: https://biostat.app.vumc.org/wiki/Main/SupportDesc.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/support.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Study to Understand Prognoses Preferences Outcomes and Risks of Treatment — support","text":"original data missing. imputation, total 9,104 individuals 47 variables. Following Bhatnagar et al. (2020), variables removed. Three response variables removed: hospital charges, patient ratio costs charges patient micro-costs. Hospital death also removed directly informative event interest, namely death. Additionally, functional disability income removed ordinal covariates. Finally, 8 covariates removed related results previous findings: SUPPORT day 3 physiology score (sps), APACHE III day 3 physiology score (aps), SUPPORT model 2-month survival estimate, SUPPORT model 6-month survival estimate, Physician's 2-month survival estimate pt., Physician's 6-month survival estimate pt., Patient Resuscitate (DNR) order, Day DNR order (<0 study). , sps aps added imputation, missing 1 observation. First imputation done manually using normal values physiological measures recommended Knaus et al. (1995). Next, single dataset imputed using mice default settings. imputation, covariate surrogate activities daily living imputed. due collinearity two covariates activities daily living. Therefore, surrogate activities daily living removed. See details R package (casebase) Bhatnagar et al. (2020).","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/support.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Study to Understand Prognoses Preferences Outcomes and Risks of Treatment — support","text":"Bhatnagar, S., Turgeon, M., Islam, J., Hanley, J. ., Saarela, O. (2020) casebase: Fitting Flexible Smooth--Time Hazards Risk Functions via Logistic Multinomial Regression. R package version 0.9.0, https://CRAN.R-project.org/package=casebase. Knaus, W. ., Harrell, F. E., Lynn, J., Goldman, L., Phillips, R. S., Connors, . F., et al. (1995) SUPPORT prognostic model: Objective estimates survival seriously ill hospitalized adults. Annals Internal Medicine, 122(3): 191-203.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/support.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Study to Understand Prognoses Preferences Outcomes and Risks of Treatment — support","text":"","code":"# \\donttest{ data(support) set.seed(123)  support <- support[support$ca %in% c(\"metastatic\"),] time <- support$d.time death <- support$death diabetes <- model.matrix(~factor(support$diabetes))[,-1] #sex: female as the reference group sex <- model.matrix(~support$sex)[,-1] #age: continuous variable age <-support$age age[support$age<=50] <- \"<50\" age[support$age>50 & support$age<=60] <- \"50-59\" age[support$age>60 & support$age<70] <- \"60-69\" age[support$age>=70] <- \"70+\" age <- factor(age, levels = c(\"60-69\", \"<50\", \"50-59\", \"70+\")) z_age <- model.matrix(~age)[,-1] z <- data.frame(z_age, sex, diabetes) colnames(z) <- c(\"age_50\", \"age_50_59\", \"age_70\", \"diabetes\", \"male\") data <- data.frame(time, death, z)  n <- nrow(data) n_ext  <- floor(0.87 * n) n_int  <- floor(0.03 * n) n_test <- n - n_ext - n_int idx      <- sample(seq_len(n)) idx_ext <- idx[       1:n_ext] idx_int <- idx[(n_ext + 1):(n_ext + n_int)] idx_test<- idx[(n_ext + n_int + 1):n]  external_data <- data[idx_ext, ] internal_data <- data[idx_int, ] test_data      <- data[idx_test, ]  library(survival) ext_cox <- coxph(   Surv(time, death) ~ age_50 + age_50_59 + age_70 + diabetes + male,   data = external_data ) beta_external <- coef(ext_cox)  result1 <- cv.coxkl(   z        = internal_data[, c(\"age_50\", \"age_50_59\", \"age_70\", \"diabetes\", \"male\")],   delta    = internal_data$death,   time     = internal_data$time,   beta     = beta_external,   stratum  = NULL,   etas = generate_eta(method = \"exponential\", n = 50, max_eta = 50) ) #> Warning: Stratum not provided. Treating all data as one stratum. cv.plot(result1)  # }"},{"path":"https://um-kevinhe.github.io/survkl/reference/test_eval.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate model performance on test data — test_eval","title":"Evaluate model performance on test data — test_eval","text":"Evaluates model performance test dataset using either log-partial-likelihood loss concordance index (C-index). function accepts either: test_z betahat, multiplied obtain risk scores; test_RS, pre-computed numeric vector risk scores.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/test_eval.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate model performance on test data — test_eval","text":"","code":"test_eval(   test_z = NULL,   test_RS = NULL,   test_delta,   test_time,   test_stratum = NULL,   betahat = NULL,   criteria = c(\"loss\", \"CIndex\") )"},{"path":"https://um-kevinhe.github.io/survkl/reference/test_eval.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate model performance on test data — test_eval","text":"test_z Optional numeric matrix data frame covariates test dataset. Required test_RS provided. test_RS Optional numeric vector pre-computed risk scores (e.g., linear predictors). provided, test_z betahat ignored. test_delta Numeric vector event indicators (1 = event, 0 = censored). test_time Numeric vector survival times test dataset. test_stratum Optional vector indicating stratum membership test observation. NULL, observations assumed belong single stratum. betahat Optional numeric vector estimated regression coefficients. Required test_RS provided. criteria Character string specifying evaluation criterion; one : \"loss\": negative twice log–partial-likelihood. \"CIndex\": concordance index.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/test_eval.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate model performance on test data — test_eval","text":"numeric value representing either: criteria = \"loss\": negative twice log–partial-likelihood test data. criteria = \"CIndex\": concordance index test data.","code":""},{"path":"https://um-kevinhe.github.io/survkl/reference/test_eval.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate model performance on test data — test_eval","text":"Prior evaluation, observations sorted (stratum, time) ensure correct risk-set construction. stratified C-index computation, provided test_stratum used; otherwise test data treated single stratum. may supply either covariates coefficients (test_z betahat) precomputed risk score vector (test_RS). test_RS provided, test_z betahat ignored.","code":""}]
