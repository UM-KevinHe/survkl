% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cal_surv_prob.R
\name{cal_surv_prob}
\alias{cal_surv_prob}
\title{Calculate Survival Probabilities}
\usage{
cal_surv_prob(z, delta, time, beta, stratum)
}
\arguments{
\item{z}{A numeric matrix (or data frame coercible to matrix) of covariates.
Each row is an observation and each column a predictor.}

\item{delta}{A numeric vector of event indicators (1 = event, 0 = censored).}

\item{time}{A numeric vector of observed times (event or censoring).}

\item{beta}{A numeric vector of regression coefficients with length equal to
the number of columns in \code{z}.}

\item{stratum}{An optional vector specifying the stratum for each observation.
If missing, a single-stratum model is assumed.}
}
\value{
A numeric matrix of survival probabilities with \code{nrow(z)} rows and
\code{length(time)} columns. Rows correspond to observations; columns are in
the internal sorted order of \code{(stratum, time)} (i.e., not collapsed to
unique event times). Entry \code{S[i, j]} is the estimated survival
probability for subject \code{i} evaluated at the \code{j}-th sorted time
point.
}
\description{
Computes individual survival probabilities from a fitted linear predictor
\code{z\%*\%beta} using a stratified Breslow-type baseline hazard estimate.
}
\details{
Inputs are internally sorted by \code{stratum} and \code{time}. Within each
stratum, a baseline hazard increment is computed as \code{delta/S0}, where
\code{S0} is the risk set sum returned by \code{ddloglik_S0}. The stratified
baseline cumulative hazard \code{Lambda0} is then formed by a cumulative sum
within stratum, and individual survival curves are computed as
\code{S(t) = exp(-Lambda0(t) * exp(z \%*\% beta))}.
}
