% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coxkl.R
\name{coxkl}
\alias{coxkl}
\title{Cox Proportional Hazards Model with KL Divergence for Data Integration}
\usage{
coxkl(
  z,
  delta,
  time,
  RS = NULL,
  beta = NULL,
  eta_list,
  tol = 1e-07,
  Mstop = 50
)
}
\arguments{
\item{z}{Numeric covariate matrix with rows representing observations and columns representing predictor variables. All variables must be numeric.}

\item{delta}{Numeric event indicator vector (1 = event occurred, 0 = censored).}

\item{time}{Numeric vector of observed event or censoring times. No sorting is required.}

\item{RS}{Numeric vector or matrix of precomputed external risk scores. Length (or number of rows) must match the number of observations. If not provided, \code{beta} must be specified.}

\item{beta}{Numeric vector of externally derived coefficients (e.g., from prior studies). Length must match the number of columns in \code{z}. Use zeros to represent absent covariates if fewer coefficients are externally available. If not provided, \code{RS} must be specified.}

\item{eta_list}{Numeric vector of tuning parameters controlling the integration strength of the external information. Higher values indicate greater reliance on external information.}

\item{tol}{Numeric scalar controlling convergence tolerance for optimization. Default is \code{1.0e-7}.}

\item{Mstop}{Integer specifying the maximum number of iterations allowed for the optimization algorithm. Default is \code{50}.}
}
\value{
A list with the following components:
\describe{
\item{\code{beta_list}}{List of estimated coefficient vectors corresponding to each \code{eta} value.}
\item{\code{LP_list}}{List of linear predictor vectors computed on the training data corresponding to each \code{eta} value.}
\item{\code{eta_list}}{Original vector of tuning parameters (\code{eta}) provided by the user.}
}
}
\description{
Estimates the coefficients of a Cox proportional hazards model incorporating external information using Kullback-Leibler (KL) divergence. External information can be integrated via precomputed external risk scores (RS) or externally derived coefficient estimates (beta). The strength of integration is controlled by tuning parameters (eta).
}
\examples{
# Example data has 6 covariates: z1, z2, z5, z6 (continuous) and z3, z4 (binary)
# External beta is simulated from a homogeneous data distribution.

# Using external beta information
result1 <- coxkl(z = ExampleData$z,
                 delta = ExampleData$status,
                 time = ExampleData$time,
                 beta = ExampleData$beta_external,
                 eta_list = seq(0, 5, 1))

# Using external risk score information
rs <- as.matrix(ExampleData$z) \%*\% as.matrix(ExampleData$beta_external)
result2 <- coxkl(z = ExampleData$z,
                 delta = ExampleData$status,
                 time = ExampleData$time,
                 RS = rs,
                 eta_list = seq(0, 5, 1))

}
