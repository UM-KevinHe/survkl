% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coxkl_ridge.R
\name{coxkl_ridge}
\alias{coxkl_ridge}
\title{Cox Proportional Hazards Model with Ridge Penalty and External Information}
\usage{
coxkl_ridge(
  z,
  delta,
  time,
  stratum = NULL,
  RS = NULL,
  beta = NULL,
  eta = NULL,
  lambda = NULL,
  nlambda = 100,
  lambda.min.ratio = ifelse(n_obs < n_vars, 0.01, 1e-04),
  penalty.factor = 0.999,
  tol = 1e-04,
  Mstop = 50,
  backtrack = FALSE,
  message = FALSE,
  data_sorted = FALSE,
  beta_initial = NULL,
  ...
)
}
\arguments{
\item{z}{Numeric matrix of covariates (observations in rows, predictors in columns).}

\item{delta}{Numeric vector of event indicators (1 = event, 0 = censored).}

\item{time}{Numeric vector of observed times.}

\item{stratum}{Optional numeric or factor vector specifying strata.}

\item{RS}{Optional numeric vector or matrix of external risk scores.}

\item{beta}{Optional numeric vector of externally derived coefficients.}

\item{eta}{Non-negative scalar controlling the strength of external information.}

\item{lambda}{Optional numeric scalar or vector of penalty parameters. If \code{NULL}, a sequence is generated automatically.}

\item{nlambda}{Number of lambda values to generate if \code{lambda} is \code{NULL}.}

\item{lambda.min.ratio}{Ratio defining the minimum lambda relative to \code{lambda.max}.}

\item{penalty.factor}{Numeric scalar in \verb{[0, 1)}. Controls the overall strength of the penalty when generating the ridge
regression lambda sequence. Smaller values correspond to stronger penalization. Only used when \code{lambda = NULL}.}

\item{tol}{Convergence tolerance for the iterative estimation algorithm.}

\item{Mstop}{Maximum number of iterations for estimation.}

\item{backtrack}{Logical; if \code{TRUE}, uses backtracking line search.}

\item{message}{Logical; if \code{TRUE}, progress messages are printed during model fitting. Default is \code{FALSE}.}

\item{data_sorted}{Logical; if \code{TRUE}, assumes input data is already sorted by strata and time.}

\item{beta_initial}{Optional; default NULL. When NULL, the algorithm initializes beta_initial to a zero vector as a warm start}

\item{...}{Additional arguments.}
}
\value{
An object of class \code{"coxkl_ridge"} containing:
\itemize{
\item \code{lambda}: The lambda sequence used for estimation.
\item \code{beta}: Matrix of estimated coefficients for each lambda.
\item \code{linear.predictors}: Matrix of linear predictors.
\item \code{likelihood}: Vector of log-partial likelihoods.
\item \code{data}: A list containing the input data used in fitting
(\code{z}, \code{time}, \code{delta}, \code{stratum}, \code{data_sorted}).
}
}
\description{
Fits a Cox proportional hazards model using a ridge-type penalty (L2) on all covariates.
The model can integrate external information either as precomputed risk scores (\code{RS})
or externally supplied coefficients (\code{beta}). A tuning parameter \code{eta} controls the
relative weight of the external information. If \code{lambda} is not provided, a lambda
sequence is automatically generated.
}
\details{
The estimator maximizes a KL-regularized Cox partial log-likelihood with a ridge (L2) penalty on all coefficients.
External information is incorporated via a KL term weighted by \code{eta}: if \code{beta} is supplied (length \code{ncol(z)}),
external risk scores are computed internally as \code{RS = z \%*\% beta}; otherwise \code{RS} must be provided.
If \code{lambda} is \code{NULL}, a decreasing lambda path of length \code{nlambda} is generated using \code{lambda.min.ratio}
(its overall scale is influenced by \code{penalty.factor}). Optimization proceeds along the lambda path with warm starts
(re-using the previous solution as \code{beta_initial}); when \code{beta_initial = NULL}, the first step uses zeros.
If \code{data_sorted = FALSE}, data are sorted by \code{stratum} and \code{time} for fitting and the returned linear predictors are
mapped back to the original observation order. \code{tol}, \code{Mstop}, and \code{backtrack} control convergence and line search.
}
\examples{
data(example_data_highdim) 

train_dat_highdim <- ExampleData_highdim$train
beta_external_highdim <- ExampleData_highdim$beta_external

model_ridge <- coxkl_ridge(z = train_dat_highdim$z,
                           delta = train_dat_highdim$status,
                           time = train_dat_highdim$time,
                           stratum = NULL,
                           RS = NULL,
                           beta = beta_external_highdim,
                           message = T)

}
